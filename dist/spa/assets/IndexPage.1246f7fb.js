import{k as _e,i as Tn,t as Ze,c as S,h as R,l as Ce,v as Wr,y as Jr,g as ce,w as Z,o as at,n as pe,K as Ji,r as z,L as Gi,M as jn,N as Qi,O as ge,q as ae,P as Rt,Q as In,m as Gr,R as xe,S as rt,U as Qr,V as Jt,W as Yi,X as Te,Y as $e,Z as Yr,$ as Xr,a0 as Zr,a1 as es,a2 as ts,a3 as ns,a4 as is,a5 as en,u as rs,a6 as ss,a7 as oi,a8 as os,s as ke,a9 as as,aa as fn,a as ls,ab as us,ac as cs,ad as ds,ae as Ln,af as hs,ag as Xi,ah as ai,ai as fs,p as vs,aj as ms,ak as gs,al as ht,A as ps,am as $t,x as ys,d as Zi,C as er,D as tr,E as nr,an as bs,j as Re,ao as ws,ap as li}from"./index.8738d3e9.js";import{c as _s,g as Ss,b as ks,a as xs,h as Cs}from"./scroll.6acec7a0.js";import{u as Ts}from"./vue-i18n.runtime.3b158adb.js";function Es(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in t)){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var Os=_e({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:e}){const{proxy:{$q:n}}=ce(),i=Tn(Wr,Ze);if(i===Ze)return console.error("QPage needs to be a deep child of QLayout"),Ze;if(Tn(Jr,Ze)===Ze)return console.error("QPage needs to be child of QPageContainer"),Ze;const s=S(()=>{const a=(i.header.space===!0?i.header.size:0)+(i.footer.space===!0?i.footer.size:0);if(typeof t.styleFn=="function"){const l=i.isContainer.value===!0?i.containerHeight.value:n.screen.height;return t.styleFn(a,l)}return{minHeight:i.isContainer.value===!0?i.containerHeight.value-a+"px":n.screen.height===0?a!==0?`calc(100vh - ${a}px)`:"100vh":n.screen.height-a+"px"}}),o=S(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>R("main",{class:o.value,style:s.value},Ce(e.default))}});const tn={dark:{type:Boolean,default:null}};function nn(t,e){return S(()=>t.dark===null?e.dark.isActive:t.dark)}function As({validate:t,resetValidation:e,requiresQForm:n}){const i=Tn(Ji,!1);if(i!==!1){const{props:r,proxy:s}=ce();Object.assign(s,{validate:t,resetValidation:e}),Z(()=>r.disable,o=>{o===!0?(typeof e=="function"&&e(),i.unbindComponent(s)):i.bindComponent(s)}),at(()=>{r.disable!==!0&&i.bindComponent(s)}),pe(()=>{r.disable!==!0&&i.unbindComponent(s)})}else n===!0&&console.error("Parent QForm not found on useFormChild()!")}const ui=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,ci=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,di=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,Ft=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,Dt=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,vn={date:t=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t),time:t=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(t),fulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(t),timeOrFulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(t),email:t=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),hexColor:t=>ui.test(t),hexaColor:t=>ci.test(t),hexOrHexaColor:t=>di.test(t),rgbColor:t=>Ft.test(t),rgbaColor:t=>Dt.test(t),rgbOrRgbaColor:t=>Ft.test(t)||Dt.test(t),hexOrRgbColor:t=>ui.test(t)||Ft.test(t),hexaOrRgbaColor:t=>ci.test(t)||Dt.test(t),anyColor:t=>di.test(t)||Ft.test(t)||Dt.test(t)},Rs=[!0,!1,"ondemand"],$s={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],validator:t=>Rs.includes(t)}};function Ps(t,e){const{props:n,proxy:i}=ce(),r=z(!1),s=z(null),o=z(null);As({validate:g,resetValidation:f});let a=0,l;const c=S(()=>n.rules!==void 0&&n.rules!==null&&n.rules.length!==0),u=S(()=>n.disable!==!0&&c.value===!0),h=S(()=>n.error===!0||r.value===!0),v=S(()=>typeof n.errorMessage=="string"&&n.errorMessage.length!==0?n.errorMessage:s.value);Z(()=>n.modelValue,()=>{C()}),Z(()=>n.reactiveRules,M=>{M===!0?l===void 0&&(l=Z(()=>n.rules,()=>{C(!0)})):l!==void 0&&(l(),l=void 0)},{immediate:!0}),Z(t,M=>{M===!0?o.value===null&&(o.value=!1):o.value===!1&&(o.value=!0,u.value===!0&&n.lazyRules!=="ondemand"&&e.value===!1&&y())});function f(){a++,e.value=!1,o.value=null,r.value=!1,s.value=null,y.cancel()}function g(M=n.modelValue){if(u.value!==!0)return!0;const E=++a,k=e.value!==!0?()=>{o.value=!0}:()=>{},O=(U,D)=>{U===!0&&k(),r.value=U,s.value=D||null,e.value=!1},j=[];for(let U=0;U<n.rules.length;U++){const D=n.rules[U];let Q;if(typeof D=="function"?Q=D(M,vn):typeof D=="string"&&vn[D]!==void 0&&(Q=vn[D](M)),Q===!1||typeof Q=="string")return O(!0,Q),!1;Q!==!0&&Q!==void 0&&j.push(Q)}return j.length===0?(O(!1),!0):(e.value=!0,Promise.all(j).then(U=>{if(U===void 0||Array.isArray(U)===!1||U.length===0)return E===a&&O(!1),!0;const D=U.find(Q=>Q===!1||typeof Q=="string");return E===a&&O(D!==void 0,D),D===void 0},U=>(E===a&&(console.error(U),O(!0)),!1)))}function C(M){u.value===!0&&n.lazyRules!=="ondemand"&&(o.value===!0||n.lazyRules!==!0&&M!==!0)&&y()}const y=Gi(g,0);return pe(()=>{l!==void 0&&l(),y.cancel()}),Object.assign(i,{resetValidation:f,validate:g}),jn(i,"hasError",()=>h.value),{isDirtyModel:o,hasRules:c,hasError:h,errorMessage:v,validate:g,resetValidation:f}}const hi=/^on[A-Z]/;function qs(t,e){const n={listeners:z({}),attributes:z({})};function i(){const r={},s={};for(const o in t)o!=="class"&&o!=="style"&&hi.test(o)===!1&&(r[o]=t[o]);for(const o in e.props)hi.test(o)===!0&&(s[o]=e.props[o]);n.attributes.value=r,n.listeners.value=s}return Qi(i),i(),n}let mn,Bt=0;const ue=new Array(256);for(let t=0;t<256;t++)ue[t]=(t+256).toString(16).substring(1);const js=(()=>{const t=typeof crypto!="undefined"?crypto:typeof window!="undefined"?window.crypto||window.msCrypto:void 0;if(t!==void 0){if(t.randomBytes!==void 0)return t.randomBytes;if(t.getRandomValues!==void 0)return e=>{const n=new Uint8Array(e);return t.getRandomValues(n),n}}return e=>{const n=[];for(let i=e;i>0;i--)n.push(Math.floor(Math.random()*256));return n}})(),fi=4096;function Is(){(mn===void 0||Bt+16>fi)&&(Bt=0,mn=js(fi));const t=Array.prototype.slice.call(mn,Bt,Bt+=16);return t[6]=t[6]&15|64,t[8]=t[8]&63|128,ue[t[0]]+ue[t[1]]+ue[t[2]]+ue[t[3]]+"-"+ue[t[4]]+ue[t[5]]+"-"+ue[t[6]]+ue[t[7]]+"-"+ue[t[8]]+ue[t[9]]+"-"+ue[t[10]]+ue[t[11]]+ue[t[12]]+ue[t[13]]+ue[t[14]]+ue[t[15]]}let Ue=[],Ct=[];function ir(t){Ct=Ct.filter(e=>e!==t)}function Ls(t){ir(t),Ct.push(t)}function vi(t){ir(t),Ct.length===0&&Ue.length!==0&&(Ue[Ue.length-1](),Ue=[])}function Pt(t){Ct.length===0?t():Ue.push(t)}function Vs(t){Ue=Ue.filter(e=>e!==t)}function En(t){return t===void 0?`f_${Is()}`:t}function Tt(t){return t!=null&&(""+t).length!==0}const rn={...tn,...$s,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String,maxlength:[Number,String]},Vn=["update:modelValue","clear","focus","blur","popupShow","popupHide"];function Mn(){const{props:t,attrs:e,proxy:n,vnode:i}=ce();return{isDark:nn(t,n.$q),editable:S(()=>t.disable!==!0&&t.readonly!==!0),innerLoading:z(!1),focused:z(!1),hasPopupOpen:!1,splitAttrs:qs(e,i),targetUid:z(En(t.for)),rootRef:z(null),targetRef:z(null),controlRef:z(null)}}function Fn(t){const{props:e,emit:n,slots:i,attrs:r,proxy:s}=ce(),{$q:o}=s;let a=null;t.hasValue===void 0&&(t.hasValue=S(()=>Tt(e.modelValue))),t.emitValue===void 0&&(t.emitValue=w=>{n("update:modelValue",w)}),t.controlEvents===void 0&&(t.controlEvents={onFocusin:b,onFocusout:x}),Object.assign(t,{clearValue:P,onControlFocusin:b,onControlFocusout:x,focus:D}),t.computedCounter===void 0&&(t.computedCounter=S(()=>{if(e.counter!==!1){const w=typeof e.modelValue=="string"||typeof e.modelValue=="number"?(""+e.modelValue).length:Array.isArray(e.modelValue)===!0?e.modelValue.length:0,K=e.maxlength!==void 0?e.maxlength:e.maxValues;return w+(K!==void 0?" / "+K:"")}}));const{isDirtyModel:l,hasRules:c,hasError:u,errorMessage:h,resetValidation:v}=Ps(t.focused,t.innerLoading),f=t.floatingLabel!==void 0?S(()=>e.stackLabel===!0||t.focused.value===!0||t.floatingLabel.value===!0):S(()=>e.stackLabel===!0||t.focused.value===!0||t.hasValue.value===!0),g=S(()=>e.bottomSlots===!0||e.hint!==void 0||c.value===!0||e.counter===!0||e.error!==null),C=S(()=>e.filled===!0?"filled":e.outlined===!0?"outlined":e.borderless===!0?"borderless":e.standout?"standout":"standard"),y=S(()=>`q-field row no-wrap items-start q-field--${C.value}`+(t.fieldClass!==void 0?` ${t.fieldClass.value}`:"")+(e.rounded===!0?" q-field--rounded":"")+(e.square===!0?" q-field--square":"")+(f.value===!0?" q-field--float":"")+(E.value===!0?" q-field--labeled":"")+(e.dense===!0?" q-field--dense":"")+(e.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(t.isDark.value===!0?" q-field--dark":"")+(t.getControl===void 0?" q-field--auto-height":"")+(t.focused.value===!0?" q-field--focused":"")+(u.value===!0?" q-field--error":"")+(u.value===!0||t.focused.value===!0?" q-field--highlighted":"")+(e.hideBottomSpace!==!0&&g.value===!0?" q-field--with-bottom":"")+(e.disable===!0?" q-field--disabled":e.readonly===!0?" q-field--readonly":"")),M=S(()=>"q-field__control relative-position row no-wrap"+(e.bgColor!==void 0?` bg-${e.bgColor}`:"")+(u.value===!0?" text-negative":typeof e.standout=="string"&&e.standout.length!==0&&t.focused.value===!0?` ${e.standout}`:e.color!==void 0?` text-${e.color}`:"")),E=S(()=>e.labelSlot===!0||e.label!==void 0),k=S(()=>"q-field__label no-pointer-events absolute ellipsis"+(e.labelColor!==void 0&&u.value!==!0?` text-${e.labelColor}`:"")),O=S(()=>({id:t.targetUid.value,editable:t.editable.value,focused:t.focused.value,floatingLabel:f.value,modelValue:e.modelValue,emitValue:t.emitValue})),j=S(()=>{const w={for:t.targetUid.value};return e.disable===!0?w["aria-disabled"]="true":e.readonly===!0&&(w["aria-readonly"]="true"),w});Z(()=>e.for,w=>{t.targetUid.value=En(w)});function U(){const w=document.activeElement;let K=t.targetRef!==void 0&&t.targetRef.value;K&&(w===null||w.id!==t.targetUid.value)&&(K.hasAttribute("tabindex")===!0||(K=K.querySelector("[tabindex]")),K&&K!==w&&K.focus({preventScroll:!0}))}function D(){Pt(U)}function Q(){Vs(U);const w=document.activeElement;w!==null&&t.rootRef.value.contains(w)&&w.blur()}function b(w){a!==null&&(clearTimeout(a),a=null),t.editable.value===!0&&t.focused.value===!1&&(t.focused.value=!0,n("focus",w))}function x(w,K){a!==null&&clearTimeout(a),a=setTimeout(()=>{a=null,!(document.hasFocus()===!0&&(t.hasPopupOpen===!0||t.controlRef===void 0||t.controlRef.value===null||t.controlRef.value.contains(document.activeElement)!==!1))&&(t.focused.value===!0&&(t.focused.value=!1,n("blur",w)),K!==void 0&&K())})}function P(w){ge(w),o.platform.is.mobile!==!0?(t.targetRef!==void 0&&t.targetRef.value||t.rootRef.value).focus():t.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),e.type==="file"&&(t.inputRef.value.value=null),n("update:modelValue",null),n("clear",e.modelValue),ae(()=>{v(),o.platform.is.mobile!==!0&&(l.value=!1)})}function T(){const w=[];return i.prepend!==void 0&&w.push(R("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:xe},i.prepend())),w.push(R("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},H())),u.value===!0&&e.noErrorIcon===!1&&w.push(J("error",[R(rt,{name:o.iconSet.field.error,color:"negative"})])),e.loading===!0||t.innerLoading.value===!0?w.push(J("inner-loading-append",i.loading!==void 0?i.loading():[R(Qr,{color:e.color})])):e.clearable===!0&&t.hasValue.value===!0&&t.editable.value===!0&&w.push(J("inner-clearable-append",[R(rt,{class:"q-field__focusable-action",tag:"button",name:e.clearIcon||o.iconSet.field.clear,tabindex:0,type:"button","aria-hidden":null,role:null,onClick:P})])),i.append!==void 0&&w.push(R("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:xe},i.append())),t.getInnerAppend!==void 0&&w.push(J("inner-append",t.getInnerAppend())),t.getControlChild!==void 0&&w.push(t.getControlChild()),w}function H(){const w=[];return e.prefix!==void 0&&e.prefix!==null&&w.push(R("div",{class:"q-field__prefix no-pointer-events row items-center"},e.prefix)),t.getShadowControl!==void 0&&t.hasShadow.value===!0&&w.push(t.getShadowControl()),t.getControl!==void 0?w.push(t.getControl()):i.rawControl!==void 0?w.push(i.rawControl()):i.control!==void 0&&w.push(R("div",{ref:t.targetRef,class:"q-field__native row",tabindex:-1,...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0},i.control(O.value))),E.value===!0&&w.push(R("div",{class:k.value},Ce(i.label,e.label))),e.suffix!==void 0&&e.suffix!==null&&w.push(R("div",{class:"q-field__suffix no-pointer-events row items-center"},e.suffix)),w.concat(Ce(i.default))}function N(){let w,K;u.value===!0?h.value!==null?(w=[R("div",{role:"alert"},h.value)],K=`q--slot-error-${h.value}`):(w=Ce(i.error),K="q--slot-error"):(e.hideHint!==!0||t.focused.value===!0)&&(e.hint!==void 0?(w=[R("div",e.hint)],K=`q--slot-hint-${e.hint}`):(w=Ce(i.hint),K="q--slot-hint"));const ie=e.counter===!0||i.counter!==void 0;if(e.hideBottomSpace===!0&&ie===!1&&w===void 0)return;const p=R("div",{key:K,class:"q-field__messages col"},w);return R("div",{class:"q-field__bottom row items-start q-field__bottom--"+(e.hideBottomSpace!==!0?"animated":"stale"),onClick:xe},[e.hideBottomSpace===!0?p:R(Jt,{name:"q-transition--field-message"},()=>p),ie===!0?R("div",{class:"q-field__counter"},i.counter!==void 0?i.counter():t.computedCounter.value):null])}function J(w,K){return K===null?null:R("div",{key:w,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},K)}let B=!1;return Rt(()=>{B=!0}),In(()=>{B===!0&&e.autofocus===!0&&s.focus()}),at(()=>{Gr.value===!0&&e.for===void 0&&(t.targetUid.value=En()),e.autofocus===!0&&s.focus()}),pe(()=>{a!==null&&clearTimeout(a)}),Object.assign(s,{focus:D,blur:Q}),function(){const K=t.getControl===void 0&&i.control===void 0?{...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0,...j.value}:j.value;return R("label",{ref:t.rootRef,class:[y.value,r.class],style:r.style,...K},[i.before!==void 0?R("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:xe},i.before()):null,R("div",{class:"q-field__inner relative-position col self-stretch"},[R("div",{ref:t.controlRef,class:M.value,tabindex:-1,...t.controlEvents},T()),g.value===!0?N():null]),i.after!==void 0?R("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:xe},i.after()):null])}}const mi={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},Gt={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleLowerCase()}},rr=Object.keys(Gt);rr.forEach(t=>{Gt[t].regex=new RegExp(Gt[t].pattern)});const Ms=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+rr.join("")+"])|(.)","g"),gi=/[.*+?^${}()|[\]\\]/g,oe=String.fromCharCode(1),Fs={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function Ds(t,e,n,i){let r,s,o,a,l,c;const u=z(null),h=z(f());function v(){return t.autogrow===!0||["textarea","text","search","url","tel","password"].includes(t.type)}Z(()=>t.type+t.autogrow,C),Z(()=>t.mask,b=>{if(b!==void 0)y(h.value,!0);else{const x=D(h.value);C(),t.modelValue!==x&&e("update:modelValue",x)}}),Z(()=>t.fillMask+t.reverseFillMask,()=>{u.value===!0&&y(h.value,!0)}),Z(()=>t.unmaskedValue,()=>{u.value===!0&&y(h.value)});function f(){if(C(),u.value===!0){const b=j(D(t.modelValue));return t.fillMask!==!1?Q(b):b}return t.modelValue}function g(b){if(b<r.length)return r.slice(-b);let x="",P=r;const T=P.indexOf(oe);if(T>-1){for(let H=b-P.length;H>0;H--)x+=oe;P=P.slice(0,T)+x+P.slice(T)}return P}function C(){if(u.value=t.mask!==void 0&&t.mask.length!==0&&v(),u.value===!1){a=void 0,r="",s="";return}const b=mi[t.mask]===void 0?t.mask:mi[t.mask],x=typeof t.fillMask=="string"&&t.fillMask.length!==0?t.fillMask.slice(0,1):"_",P=x.replace(gi,"\\$&"),T=[],H=[],N=[];let J=t.reverseFillMask===!0,B="",w="";b.replace(Ms,(_,m,I,G,V)=>{if(G!==void 0){const q=Gt[G];N.push(q),w=q.negate,J===!0&&(H.push("(?:"+w+"+)?("+q.pattern+"+)?(?:"+w+"+)?("+q.pattern+"+)?"),J=!1),H.push("(?:"+w+"+)?("+q.pattern+")?")}else if(I!==void 0)B="\\"+(I==="\\"?"":I),N.push(I),T.push("([^"+B+"]+)?"+B+"?");else{const q=m!==void 0?m:V;B=q==="\\"?"\\\\\\\\":q.replace(gi,"\\\\$&"),N.push(q),T.push("([^"+B+"]+)?"+B+"?")}});const K=new RegExp("^"+T.join("")+"("+(B===""?".":"[^"+B+"]")+"+)?"+(B===""?"":"["+B+"]*")+"$"),ie=H.length-1,p=H.map((_,m)=>m===0&&t.reverseFillMask===!0?new RegExp("^"+P+"*"+_):m===ie?new RegExp("^"+_+"("+(w===""?".":w)+"+)?"+(t.reverseFillMask===!0?"$":P+"*")):new RegExp("^"+_));o=N,a=_=>{const m=K.exec(t.reverseFillMask===!0?_:_.slice(0,N.length+1));m!==null&&(_=m.slice(1).join(""));const I=[],G=p.length;for(let V=0,q=_;V<G;V++){const F=p[V].exec(q);if(F===null)break;q=q.slice(F.shift().length),I.push(...F)}return I.length!==0?I.join(""):_},r=N.map(_=>typeof _=="string"?_:oe).join(""),s=r.split(oe).join(x)}function y(b,x,P){const T=i.value,H=T.selectionEnd,N=T.value.length-H,J=D(b);x===!0&&C();const B=j(J),w=t.fillMask!==!1?Q(B):B,K=h.value!==w;T.value!==w&&(T.value=w),K===!0&&(h.value=w),document.activeElement===T&&ae(()=>{if(w===s){const p=t.reverseFillMask===!0?s.length:0;T.setSelectionRange(p,p,"forward");return}if(P==="insertFromPaste"&&t.reverseFillMask!==!0){const p=T.selectionEnd;let _=H-1;for(let m=l;m<=_&&m<p;m++)r[m]!==oe&&_++;E.right(T,_);return}if(["deleteContentBackward","deleteContentForward"].indexOf(P)>-1){const p=t.reverseFillMask===!0?H===0?w.length>B.length?1:0:Math.max(0,w.length-(w===s?0:Math.min(B.length,N)+1))+1:H;T.setSelectionRange(p,p,"forward");return}if(t.reverseFillMask===!0)if(K===!0){const p=Math.max(0,w.length-(w===s?0:Math.min(B.length,N+1)));p===1&&H===1?T.setSelectionRange(p,p,"forward"):E.rightReverse(T,p)}else{const p=w.length-N;T.setSelectionRange(p,p,"backward")}else if(K===!0){const p=Math.max(0,r.indexOf(oe),Math.min(B.length,H)-1);E.right(T,p)}else{const p=H-1;E.right(T,p)}});const ie=t.unmaskedValue===!0?D(w):w;String(t.modelValue)!==ie&&n(ie,!0)}function M(b,x,P){const T=j(D(b.value));x=Math.max(0,r.indexOf(oe),Math.min(T.length,x)),l=x,b.setSelectionRange(x,P,"forward")}const E={left(b,x){const P=r.slice(x-1).indexOf(oe)===-1;let T=Math.max(0,x-1);for(;T>=0;T--)if(r[T]===oe){x=T,P===!0&&x++;break}if(T<0&&r[x]!==void 0&&r[x]!==oe)return E.right(b,0);x>=0&&b.setSelectionRange(x,x,"backward")},right(b,x){const P=b.value.length;let T=Math.min(P,x+1);for(;T<=P;T++)if(r[T]===oe){x=T;break}else r[T-1]===oe&&(x=T);if(T>P&&r[x-1]!==void 0&&r[x-1]!==oe)return E.left(b,P);b.setSelectionRange(x,x,"forward")},leftReverse(b,x){const P=g(b.value.length);let T=Math.max(0,x-1);for(;T>=0;T--)if(P[T-1]===oe){x=T;break}else if(P[T]===oe&&(x=T,T===0))break;if(T<0&&P[x]!==void 0&&P[x]!==oe)return E.rightReverse(b,0);x>=0&&b.setSelectionRange(x,x,"backward")},rightReverse(b,x){const P=b.value.length,T=g(P),H=T.slice(0,x+1).indexOf(oe)===-1;let N=Math.min(P,x+1);for(;N<=P;N++)if(T[N-1]===oe){x=N,x>0&&H===!0&&x--;break}if(N>P&&T[x-1]!==void 0&&T[x-1]!==oe)return E.leftReverse(b,P);b.setSelectionRange(x,x,"forward")}};function k(b){e("click",b),c=void 0}function O(b){if(e("keydown",b),Yi(b)===!0||b.altKey===!0)return;const x=i.value,P=x.selectionStart,T=x.selectionEnd;if(b.shiftKey||(c=void 0),b.keyCode===37||b.keyCode===39){b.shiftKey&&c===void 0&&(c=x.selectionDirection==="forward"?P:T);const H=E[(b.keyCode===39?"right":"left")+(t.reverseFillMask===!0?"Reverse":"")];if(b.preventDefault(),H(x,c===P?T:P),b.shiftKey){const N=x.selectionStart;x.setSelectionRange(Math.min(c,N),Math.max(c,N),"forward")}}else b.keyCode===8&&t.reverseFillMask!==!0&&P===T?(E.left(x,P),x.setSelectionRange(x.selectionStart,T,"backward")):b.keyCode===46&&t.reverseFillMask===!0&&P===T&&(E.rightReverse(x,T),x.setSelectionRange(P,x.selectionEnd,"forward"))}function j(b){if(b==null||b==="")return"";if(t.reverseFillMask===!0)return U(b);const x=o;let P=0,T="";for(let H=0;H<x.length;H++){const N=b[P],J=x[H];if(typeof J=="string")T+=J,N===J&&P++;else if(N!==void 0&&J.regex.test(N))T+=J.transform!==void 0?J.transform(N):N,P++;else return T}return T}function U(b){const x=o,P=r.indexOf(oe);let T=b.length-1,H="";for(let N=x.length-1;N>=0&&T>-1;N--){const J=x[N];let B=b[T];if(typeof J=="string")H=J+H,B===J&&T--;else if(B!==void 0&&J.regex.test(B))do H=(J.transform!==void 0?J.transform(B):B)+H,T--,B=b[T];while(P===N&&B!==void 0&&J.regex.test(B));else return H}return H}function D(b){return typeof b!="string"||a===void 0?typeof b=="number"?a(""+b):b:a(b)}function Q(b){return s.length-b.length<=0?b:t.reverseFillMask===!0&&b.length!==0?s.slice(0,-b.length)+b:b+s.slice(b.length)}return{innerValue:h,hasMask:u,moveCursorForPaste:M,updateMaskValue:y,onMaskedKeydown:O,onMaskedClick:k}}const sr={name:String};function or(t){return S(()=>t.name||t.for)}function Bs(t,e){function n(){const i=t.modelValue;try{const r="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(i)===i&&("length"in i?Array.from(i):[i]).forEach(s=>{r.items.add(s)}),{files:r.files}}catch{return{files:void 0}}}return e===!0?S(()=>{if(t.type==="file")return n()}):S(n)}const Us=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,zs=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,Hs=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,Ns=/[a-z0-9_ -]$/i;function ar(t){return function(n){if(n.type==="compositionend"||n.type==="change"){if(n.target.qComposing!==!0)return;n.target.qComposing=!1,t(n)}else n.type==="compositionupdate"&&n.target.qComposing!==!0&&typeof n.data=="string"&&(Te.is.firefox===!0?Ns.test(n.data)===!1:Us.test(n.data)===!0||zs.test(n.data)===!0||Hs.test(n.data)===!0)===!0&&(n.target.qComposing=!0)}}var Ut=_e({name:"QInput",inheritAttrs:!1,props:{...rn,...Fs,...sr,modelValue:{required:!1},shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Vn,"paste","change","keydown","click","animationend"],setup(t,{emit:e,attrs:n}){const{proxy:i}=ce(),{$q:r}=i,s={};let o=NaN,a,l,c=null,u;const h=z(null),v=or(t),{innerValue:f,hasMask:g,moveCursorForPaste:C,updateMaskValue:y,onMaskedKeydown:M,onMaskedClick:E}=Ds(t,e,B,h),k=Bs(t,!0),O=S(()=>Tt(f.value)),j=ar(N),U=Mn(),D=S(()=>t.type==="textarea"||t.autogrow===!0),Q=S(()=>D.value===!0||["text","search","url","tel","password"].includes(t.type)),b=S(()=>{const m={...U.splitAttrs.listeners.value,onInput:N,onPaste:H,onChange:K,onBlur:ie,onFocus:$e};return m.onCompositionstart=m.onCompositionupdate=m.onCompositionend=j,g.value===!0&&(m.onKeydown=M,m.onClick=E),t.autogrow===!0&&(m.onAnimationend=J),m}),x=S(()=>{const m={tabindex:0,"data-autofocus":t.autofocus===!0||void 0,rows:t.type==="textarea"?6:void 0,"aria-label":t.label,name:v.value,...U.splitAttrs.attributes.value,id:U.targetUid.value,maxlength:t.maxlength,disabled:t.disable===!0,readonly:t.readonly===!0};return D.value===!1&&(m.type=t.type),t.autogrow===!0&&(m.rows=1),m});Z(()=>t.type,()=>{h.value&&(h.value.value=t.modelValue)}),Z(()=>t.modelValue,m=>{if(g.value===!0){if(l===!0&&(l=!1,String(m)===o))return;y(m)}else f.value!==m&&(f.value=m,t.type==="number"&&s.hasOwnProperty("value")===!0&&(a===!0?a=!1:delete s.value));t.autogrow===!0&&ae(w)}),Z(()=>t.autogrow,m=>{m===!0?ae(w):h.value!==null&&n.rows>0&&(h.value.style.height="auto")}),Z(()=>t.dense,()=>{t.autogrow===!0&&ae(w)});function P(){Pt(()=>{const m=document.activeElement;h.value!==null&&h.value!==m&&(m===null||m.id!==U.targetUid.value)&&h.value.focus({preventScroll:!0})})}function T(){h.value!==null&&h.value.select()}function H(m){if(g.value===!0&&t.reverseFillMask!==!0){const I=m.target;C(I,I.selectionStart,I.selectionEnd)}e("paste",m)}function N(m){if(!m||!m.target)return;if(t.type==="file"){e("update:modelValue",m.target.files);return}const I=m.target.value;if(m.target.qComposing===!0){s.value=I;return}if(g.value===!0)y(I,!1,m.inputType);else if(B(I),Q.value===!0&&m.target===document.activeElement){const{selectionStart:G,selectionEnd:V}=m.target;G!==void 0&&V!==void 0&&ae(()=>{m.target===document.activeElement&&I.indexOf(m.target.value)===0&&m.target.setSelectionRange(G,V)})}t.autogrow===!0&&w()}function J(m){e("animationend",m),w()}function B(m,I){u=()=>{c=null,t.type!=="number"&&s.hasOwnProperty("value")===!0&&delete s.value,t.modelValue!==m&&o!==m&&(o=m,I===!0&&(l=!0),e("update:modelValue",m),ae(()=>{o===m&&(o=NaN)})),u=void 0},t.type==="number"&&(a=!0,s.value=m),t.debounce!==void 0?(c!==null&&clearTimeout(c),s.value=m,c=setTimeout(u,t.debounce)):u()}function w(){requestAnimationFrame(()=>{const m=h.value;if(m!==null){const I=m.parentNode.style,{scrollTop:G}=m,{overflowY:V,maxHeight:q}=r.platform.is.firefox===!0?{}:window.getComputedStyle(m),F=V!==void 0&&V!=="scroll";F===!0&&(m.style.overflowY="hidden"),I.marginBottom=m.scrollHeight-1+"px",m.style.height="1px",m.style.height=m.scrollHeight+"px",F===!0&&(m.style.overflowY=parseInt(q,10)<m.scrollHeight?"auto":"hidden"),I.marginBottom="",m.scrollTop=G}})}function K(m){j(m),c!==null&&(clearTimeout(c),c=null),u!==void 0&&u(),e("change",m.target.value)}function ie(m){m!==void 0&&$e(m),c!==null&&(clearTimeout(c),c=null),u!==void 0&&u(),a=!1,l=!1,delete s.value,t.type!=="file"&&setTimeout(()=>{h.value!==null&&(h.value.value=f.value!==void 0?f.value:"")})}function p(){return s.hasOwnProperty("value")===!0?s.value:f.value!==void 0?f.value:""}pe(()=>{ie()}),at(()=>{t.autogrow===!0&&w()}),Object.assign(U,{innerValue:f,fieldClass:S(()=>`q-${D.value===!0?"textarea":"input"}`+(t.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:S(()=>t.type!=="file"&&typeof t.shadowText=="string"&&t.shadowText.length!==0),inputRef:h,emitValue:B,hasValue:O,floatingLabel:S(()=>O.value===!0&&(t.type!=="number"||isNaN(f.value)===!1)||Tt(t.displayValue)),getControl:()=>R(D.value===!0?"textarea":"input",{ref:h,class:["q-field__native q-placeholder",t.inputClass],style:t.inputStyle,...x.value,...b.value,...t.type!=="file"?{value:p()}:k.value}),getShadowControl:()=>R("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(D.value===!0?"":" text-no-wrap")},[R("span",{class:"invisible"},p()),R("span",t.shadowText)])});const _=Fn(U);return Object.assign(i,{focus:P,select:T,getNativeElement:()=>h.value}),jn(i,"nativeEl",()=>h.value),_}}),Ks=_e({name:"QField",inheritAttrs:!1,props:rn,emits:Vn,setup(){return Fn(Mn())}});const Ws={xs:8,sm:10,md:14,lg:20,xl:24};var Js=_e({name:"QChip",props:{...tn,...Yr,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=ce(),r=nn(t,i),s=Xr(t,Ws),o=S(()=>t.selected===!0||t.icon!==void 0),a=S(()=>t.selected===!0?t.iconSelected||i.iconSet.chip.selected:t.icon),l=S(()=>t.iconRemove||i.iconSet.chip.remove),c=S(()=>t.disable===!1&&(t.clickable===!0||t.selected!==null)),u=S(()=>{const y=t.outline===!0&&t.color||t.textColor;return"q-chip row inline no-wrap items-center"+(t.outline===!1&&t.color!==void 0?` bg-${t.color}`:"")+(y?` text-${y} q-chip--colored`:"")+(t.disable===!0?" disabled":"")+(t.dense===!0?" q-chip--dense":"")+(t.outline===!0?" q-chip--outline":"")+(t.selected===!0?" q-chip--selected":"")+(c.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(t.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),h=S(()=>{const y=t.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:t.tabindex||0},M={...y,role:"button","aria-hidden":"false","aria-label":t.removeAriaLabel||i.lang.label.remove};return{chip:y,remove:M}});function v(y){y.keyCode===13&&f(y)}function f(y){t.disable||(n("update:selected",!t.selected),n("click",y))}function g(y){(y.keyCode===void 0||y.keyCode===13)&&(ge(y),t.disable===!1&&(n("update:modelValue",!1),n("remove")))}function C(){const y=[];c.value===!0&&y.push(R("div",{class:"q-focus-helper"})),o.value===!0&&y.push(R(rt,{class:"q-chip__icon q-chip__icon--left",name:a.value}));const M=t.label!==void 0?[R("div",{class:"ellipsis"},[t.label])]:void 0;return y.push(R("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},es(e.default,M))),t.iconRight&&y.push(R(rt,{class:"q-chip__icon q-chip__icon--right",name:t.iconRight})),t.removable===!0&&y.push(R(rt,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...h.value.remove,onClick:g,onKeyup:g})),y}return()=>{if(t.modelValue===!1)return;const y={class:u.value,style:s.value};return c.value===!0&&Object.assign(y,h.value.chip,{onClick:f,onKeyup:v}),Zr("div",y,C(),"ripple",t.ripple!==!1&&t.disable!==!0,()=>[[ts,t.ripple]])}}}),Gs=_e({name:"QItem",props:{...tn,...ns,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=ce(),r=nn(t,i),{hasLink:s,linkAttrs:o,linkClass:a,linkTag:l,navigateOnClick:c}=is(),u=z(null),h=z(null),v=S(()=>t.clickable===!0||s.value===!0||t.tag==="label"),f=S(()=>t.disable!==!0&&v.value===!0),g=S(()=>"q-item q-item-type row no-wrap"+(t.dense===!0?" q-item--dense":"")+(r.value===!0?" q-item--dark":"")+(s.value===!0&&t.active===null?a.value:t.active===!0?` q-item--active${t.activeClass!==void 0?` ${t.activeClass}`:""}`:"")+(t.disable===!0?" disabled":"")+(f.value===!0?" q-item--clickable q-link cursor-pointer "+(t.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(t.focused===!0?" q-manual-focusable--focused":""):"")),C=S(()=>{if(t.insetLevel===void 0)return null;const k=i.lang.rtl===!0?"Right":"Left";return{["padding"+k]:16+t.insetLevel*56+"px"}});function y(k){f.value===!0&&(h.value!==null&&(k.qKeyEvent!==!0&&document.activeElement===u.value?h.value.focus():document.activeElement===h.value&&u.value.focus()),c(k))}function M(k){if(f.value===!0&&en(k,13)===!0){ge(k),k.qKeyEvent=!0;const O=new MouseEvent("click",k);O.qKeyEvent=!0,u.value.dispatchEvent(O)}n("keyup",k)}function E(){const k=rs(e.default,[]);return f.value===!0&&k.unshift(R("div",{class:"q-focus-helper",tabindex:-1,ref:h})),k}return()=>{const k={ref:u,class:g.value,style:C.value,role:"listitem",onClick:y,onKeyup:M};return f.value===!0?(k.tabindex=t.tabindex||"0",Object.assign(k,o.value)):v.value===!0&&(k["aria-disabled"]="true"),R(l.value,k,E())}}}),Qs=_e({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(t,{slots:e}){const n=S(()=>`q-item__section column q-item__section--${t.avatar===!0||t.side===!0||t.thumbnail===!0?"side":"main"}`+(t.top===!0?" q-item__section--top justify-start":" justify-center")+(t.avatar===!0?" q-item__section--avatar":"")+(t.thumbnail===!0?" q-item__section--thumbnail":"")+(t.noWrap===!0?" q-item__section--nowrap":""));return()=>R("div",{class:n.value},Ce(e.default))}}),Ys=_e({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(t,{slots:e}){const n=S(()=>parseInt(t.lines,10)),i=S(()=>"q-item__label"+(t.overline===!0?" q-item__label--overline text-overline":"")+(t.caption===!0?" q-item__label--caption text-caption":"")+(t.header===!0?" q-item__label--header":"")+(n.value===1?" ellipsis":"")),r=S(()=>t.lines!==void 0&&n.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":n.value}:null);return()=>R("div",{style:r.value,class:i.value},Ce(e.default))}});function Xs(){if(window.getSelection!==void 0){const t=window.getSelection();t.empty!==void 0?t.empty():t.removeAllRanges!==void 0&&(t.removeAllRanges(),ss.is.mobile!==!0&&t.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const Zs={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function eo({showing:t,avoidEmit:e,configureAnchorEl:n}){const{props:i,proxy:r,emit:s}=ce(),o=z(null);let a=null;function l(f){return o.value===null?!1:f===void 0||f.touches===void 0||f.touches.length<=1}const c={};n===void 0&&(Object.assign(c,{hide(f){r.hide(f)},toggle(f){r.toggle(f),f.qAnchorHandled=!0},toggleKey(f){en(f,13)===!0&&c.toggle(f)},contextClick(f){r.hide(f),xe(f),ae(()=>{r.show(f),f.qAnchorHandled=!0})},prevent:xe,mobileTouch(f){if(c.mobileCleanup(f),l(f)!==!0)return;r.hide(f),o.value.classList.add("non-selectable");const g=f.target;oi(c,"anchor",[[g,"touchmove","mobileCleanup","passive"],[g,"touchend","mobileCleanup","passive"],[g,"touchcancel","mobileCleanup","passive"],[o.value,"contextmenu","prevent","notPassive"]]),a=setTimeout(()=>{a=null,r.show(f),f.qAnchorHandled=!0},300)},mobileCleanup(f){o.value.classList.remove("non-selectable"),a!==null&&(clearTimeout(a),a=null),t.value===!0&&f!==void 0&&Xs()}}),n=function(f=i.contextMenu){if(i.noParentEvent===!0||o.value===null)return;let g;f===!0?r.$q.platform.is.mobile===!0?g=[[o.value,"touchstart","mobileTouch","passive"]]:g=[[o.value,"mousedown","hide","passive"],[o.value,"contextmenu","contextClick","notPassive"]]:g=[[o.value,"click","toggle","passive"],[o.value,"keyup","toggleKey","passive"]],oi(c,"anchor",g)});function u(){os(c,"anchor")}function h(f){for(o.value=f;o.value.classList.contains("q-anchor--skip");)o.value=o.value.parentNode;n()}function v(){if(i.target===!1||i.target===""||r.$el.parentNode===null)o.value=null;else if(i.target===!0)h(r.$el.parentNode);else{let f=i.target;if(typeof i.target=="string")try{f=document.querySelector(i.target)}catch{f=void 0}f!=null?(o.value=f.$el||f,n()):(o.value=null,console.error(`Anchor: target "${i.target}" not found`))}}return Z(()=>i.contextMenu,f=>{o.value!==null&&(u(),n(f))}),Z(()=>i.target,()=>{o.value!==null&&u(),v()}),Z(()=>i.noParentEvent,f=>{o.value!==null&&(f===!0?u():n())}),at(()=>{v(),e!==!0&&i.modelValue===!0&&o.value===null&&s("update:modelValue",!1)}),pe(()=>{a!==null&&clearTimeout(a),u()}),{anchorEl:o,canShow:l,anchorEvents:c}}function to(t,e){const n=z(null);let i;function r(a,l){const c=`${l!==void 0?"add":"remove"}EventListener`,u=l!==void 0?l:i;a!==window&&a[c]("scroll",u,ke.passive),window[c]("scroll",u,ke.passive),i=l}function s(){n.value!==null&&(r(n.value),n.value=null)}const o=Z(()=>t.noParentEvent,()=>{n.value!==null&&(s(),e())});return pe(o),{localScrollTarget:n,unconfigureScrollTarget:s,changeScrollEvent:r}}const lr={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},ur=["beforeShow","show","beforeHide","hide"];function cr({showing:t,canShow:e,hideOnRouteChange:n,handleShow:i,handleHide:r,processOnMount:s}){const o=ce(),{props:a,emit:l,proxy:c}=o;let u;function h(E){t.value===!0?g(E):v(E)}function v(E){if(a.disable===!0||E!==void 0&&E.qAnchorHandled===!0||e!==void 0&&e(E)!==!0)return;const k=a["onUpdate:modelValue"]!==void 0;k===!0&&(l("update:modelValue",!0),u=E,ae(()=>{u===E&&(u=void 0)})),(a.modelValue===null||k===!1)&&f(E)}function f(E){t.value!==!0&&(t.value=!0,l("beforeShow",E),i!==void 0?i(E):l("show",E))}function g(E){if(a.disable===!0)return;const k=a["onUpdate:modelValue"]!==void 0;k===!0&&(l("update:modelValue",!1),u=E,ae(()=>{u===E&&(u=void 0)})),(a.modelValue===null||k===!1)&&C(E)}function C(E){t.value!==!1&&(t.value=!1,l("beforeHide",E),r!==void 0?r(E):l("hide",E))}function y(E){a.disable===!0&&E===!0?a["onUpdate:modelValue"]!==void 0&&l("update:modelValue",!1):E===!0!==t.value&&(E===!0?f:C)(u)}Z(()=>a.modelValue,y),n!==void 0&&as(o)===!0&&Z(()=>c.$route.fullPath,()=>{n.value===!0&&t.value===!0&&g()}),s===!0&&at(()=>{y(a.modelValue)});const M={show:v,hide:g,toggle:h};return Object.assign(c,M),M}const _t=[];function no(t,e){do{if(t.$options.name==="QMenu"){if(t.hide(e),t.$props.separateClosePopup===!0)return fn(t)}else if(t.__qPortal===!0){const n=fn(t);return n!==void 0&&n.$options.name==="QPopupProxy"?(t.hide(e),n):t}t=fn(t)}while(t!=null)}function io(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function dr(t,e,n,i){const r=z(!1),s=z(!1);let o=null;const a={},l=i==="dialog"&&io(t);function c(h){if(h===!0){vi(a),s.value=!0;return}s.value=!1,r.value===!1&&(l===!1&&o===null&&(o=cs(!1,i)),r.value=!0,_t.push(t.proxy),Ls(a))}function u(h){if(s.value=!1,h!==!0)return;vi(a),r.value=!1;const v=_t.indexOf(t.proxy);v!==-1&&_t.splice(v,1),o!==null&&(ds(o),o=null)}return ls(()=>{u(!0)}),t.proxy.__qPortal=!0,jn(t.proxy,"contentEl",()=>e.value),{showPortal:c,hidePortal:u,portalIsActive:r,portalIsAccessible:s,renderPortal:()=>l===!0?n():r.value===!0?[R(us,{to:o},n())]:void 0}}const hr={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function fr(t,e=()=>{},n=()=>{}){return{transitionProps:S(()=>{const i=`q-transition--${t.transitionShow||e()}`,r=`q-transition--${t.transitionHide||n()}`;return{appear:!0,enterFromClass:`${i}-enter-from`,enterActiveClass:`${i}-enter-active`,enterToClass:`${i}-enter-to`,leaveFromClass:`${r}-leave-from`,leaveActiveClass:`${r}-leave-active`,leaveToClass:`${r}-leave-to`}}),transitionStyle:S(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}function vr(){let t;const e=ce();function n(){t=void 0}return Rt(n),pe(n),{removeTick:n,registerTick(i){t=i,ae(()=>{t===i&&(Ln(e)===!1&&t(),t=void 0)})}}}function mr(){let t=null;const e=ce();function n(){t!==null&&(clearTimeout(t),t=null)}return Rt(n),pe(n),{removeTimeout:n,registerTimeout(i,r){n(),Ln(e)===!1&&(t=setTimeout(i,r))}}}const ze=[];let ot;function ro(t){ot=t.keyCode===27}function so(){ot===!0&&(ot=!1)}function oo(t){ot===!0&&(ot=!1,en(t,27)===!0&&ze[ze.length-1](t))}function gr(t){window[t]("keydown",ro),window[t]("blur",so),window[t]("keyup",oo),ot=!1}function pr(t){Te.is.desktop===!0&&(ze.push(t),ze.length===1&&gr("addEventListener"))}function Qt(t){const e=ze.indexOf(t);e>-1&&(ze.splice(e,1),ze.length===0&&gr("removeEventListener"))}const He=[];function yr(t){He[He.length-1](t)}function br(t){Te.is.desktop===!0&&(He.push(t),He.length===1&&document.body.addEventListener("focusin",yr))}function On(t){const e=He.indexOf(t);e>-1&&(He.splice(e,1),He.length===0&&document.body.removeEventListener("focusin",yr))}const{notPassiveCapture:Yt}=ke,Ne=[];function Xt(t){const e=t.target;if(e===void 0||e.nodeType===8||e.classList.contains("no-pointer-events")===!0)return;let n=_t.length-1;for(;n>=0;){const i=_t[n].$;if(i.type.name==="QTooltip"){n--;continue}if(i.type.name!=="QDialog")break;if(i.props.seamless!==!0)return;n--}for(let i=Ne.length-1;i>=0;i--){const r=Ne[i];if((r.anchorEl.value===null||r.anchorEl.value.contains(e)===!1)&&(e===document.body||r.innerRef.value!==null&&r.innerRef.value.contains(e)===!1))t.qClickOutside=!0,r.onClickOutside(t);else return}}function ao(t){Ne.push(t),Ne.length===1&&(document.addEventListener("mousedown",Xt,Yt),document.addEventListener("touchstart",Xt,Yt))}function pi(t){const e=Ne.findIndex(n=>n===t);e>-1&&(Ne.splice(e,1),Ne.length===0&&(document.removeEventListener("mousedown",Xt,Yt),document.removeEventListener("touchstart",Xt,Yt)))}let yi,bi;function wi(t){const e=t.split(" ");return e.length!==2?!1:["top","center","bottom"].includes(e[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(e[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function lo(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const An={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{An[`${t}#ltr`]=t,An[`${t}#rtl`]=t});function _i(t,e){const n=t.split(" ");return{vertical:n[0],horizontal:An[`${n[1]}#${e===!0?"rtl":"ltr"}`]}}function uo(t,e){let{top:n,left:i,right:r,bottom:s,width:o,height:a}=t.getBoundingClientRect();return e!==void 0&&(n-=e[1],i-=e[0],s+=e[1],r+=e[0],o+=e[0],a+=e[1]),{top:n,bottom:s,height:a,left:i,right:r,width:o,middle:i+(r-i)/2,center:n+(s-n)/2}}function co(t,e,n){let{top:i,left:r}=t.getBoundingClientRect();return i+=e.top,r+=e.left,n!==void 0&&(i+=n[1],r+=n[0]),{top:i,bottom:i+1,height:1,left:r,right:r+1,width:1,middle:r,center:i}}function ho(t,e){return{top:0,center:e/2,bottom:e,left:0,middle:t/2,right:t}}function Si(t,e,n,i){return{top:t[n.vertical]-e[i.vertical],left:t[n.horizontal]-e[i.horizontal]}}function wr(t,e=0){if(t.targetEl===null||t.anchorEl===null||e>5)return;if(t.targetEl.offsetHeight===0||t.targetEl.offsetWidth===0){setTimeout(()=>{wr(t,e+1)},10);return}const{targetEl:n,offset:i,anchorEl:r,anchorOrigin:s,selfOrigin:o,absoluteOffset:a,fit:l,cover:c,maxHeight:u,maxWidth:h}=t;if(Te.is.ios===!0&&window.visualViewport!==void 0){const U=document.body.style,{offsetLeft:D,offsetTop:Q}=window.visualViewport;D!==yi&&(U.setProperty("--q-pe-left",D+"px"),yi=D),Q!==bi&&(U.setProperty("--q-pe-top",Q+"px"),bi=Q)}const{scrollLeft:v,scrollTop:f}=n,g=a===void 0?uo(r,c===!0?[0,0]:i):co(r,a,i);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:h||"100vw",maxHeight:u||"100vh",visibility:"visible"});const{offsetWidth:C,offsetHeight:y}=n,{elWidth:M,elHeight:E}=l===!0||c===!0?{elWidth:Math.max(g.width,C),elHeight:c===!0?Math.max(g.height,y):y}:{elWidth:C,elHeight:y};let k={maxWidth:h,maxHeight:u};(l===!0||c===!0)&&(k.minWidth=g.width+"px",c===!0&&(k.minHeight=g.height+"px")),Object.assign(n.style,k);const O=ho(M,E);let j=Si(g,O,s,o);if(a===void 0||i===void 0)gn(j,g,O,s,o);else{const{top:U,left:D}=j;gn(j,g,O,s,o);let Q=!1;if(j.top!==U){Q=!0;const b=2*i[1];g.center=g.top-=b,g.bottom-=b+2}if(j.left!==D){Q=!0;const b=2*i[0];g.middle=g.left-=b,g.right-=b+2}Q===!0&&(j=Si(g,O,s,o),gn(j,g,O,s,o))}k={top:j.top+"px",left:j.left+"px"},j.maxHeight!==void 0&&(k.maxHeight=j.maxHeight+"px",g.height>j.maxHeight&&(k.minHeight=k.maxHeight)),j.maxWidth!==void 0&&(k.maxWidth=j.maxWidth+"px",g.width>j.maxWidth&&(k.minWidth=k.maxWidth)),Object.assign(n.style,k),n.scrollTop!==f&&(n.scrollTop=f),n.scrollLeft!==v&&(n.scrollLeft=v)}function gn(t,e,n,i,r){const s=n.bottom,o=n.right,a=_s(),l=window.innerHeight-a,c=document.body.clientWidth;if(t.top<0||t.top+s>l)if(r.vertical==="center")t.top=e[i.vertical]>l/2?Math.max(0,l-s):0,t.maxHeight=Math.min(s,l);else if(e[i.vertical]>l/2){const u=Math.min(l,i.vertical==="center"?e.center:i.vertical===r.vertical?e.bottom:e.top);t.maxHeight=Math.min(s,u),t.top=Math.max(0,u-s)}else t.top=Math.max(0,i.vertical==="center"?e.center:i.vertical===r.vertical?e.top:e.bottom),t.maxHeight=Math.min(s,l-t.top);if(t.left<0||t.left+o>c)if(t.maxWidth=Math.min(o,c),r.horizontal==="middle")t.left=e[i.horizontal]>c/2?Math.max(0,c-o):0;else if(e[i.horizontal]>c/2){const u=Math.min(c,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.right:e.left);t.maxWidth=Math.min(o,u),t.left=Math.max(0,u-t.maxWidth)}else t.left=Math.max(0,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.left:e.right),t.maxWidth=Math.min(o,c-t.left)}var fo=_e({name:"QMenu",inheritAttrs:!1,props:{...Zs,...lr,...tn,...hr,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:wi},self:{type:String,validator:wi},offset:{type:Array,validator:lo},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ur,"click","escapeKey"],setup(t,{slots:e,emit:n,attrs:i}){let r=null,s,o,a;const l=ce(),{proxy:c}=l,{$q:u}=c,h=z(null),v=z(!1),f=S(()=>t.persistent!==!0&&t.noRouteDismiss!==!0),g=nn(t,u),{registerTick:C,removeTick:y}=vr(),{registerTimeout:M}=mr(),{transitionProps:E,transitionStyle:k}=fr(t),{localScrollTarget:O,changeScrollEvent:j,unconfigureScrollTarget:U}=to(t,I),{anchorEl:D,canShow:Q}=eo({showing:v}),{hide:b}=cr({showing:v,canShow:Q,handleShow:p,handleHide:_,hideOnRouteChange:f,processOnMount:!0}),{showPortal:x,hidePortal:P,renderPortal:T}=dr(l,h,re,"menu"),H={anchorEl:D,innerRef:h,onClickOutside(A){if(t.persistent!==!0&&v.value===!0)return b(A),(A.type==="touchstart"||A.target.classList.contains("q-dialog__backdrop"))&&ge(A),!0}},N=S(()=>_i(t.anchor||(t.cover===!0?"center middle":"bottom start"),u.lang.rtl)),J=S(()=>t.cover===!0?N.value:_i(t.self||"top start",u.lang.rtl)),B=S(()=>(t.square===!0?" q-menu--square":"")+(g.value===!0?" q-menu--dark q-dark":"")),w=S(()=>t.autoClose===!0?{onClick:G}:{}),K=S(()=>v.value===!0&&t.persistent!==!0);Z(K,A=>{A===!0?(pr(q),ao(H)):(Qt(q),pi(H))});function ie(){Pt(()=>{let A=h.value;A&&A.contains(document.activeElement)!==!0&&(A=A.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||A.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||A.querySelector("[autofocus], [data-autofocus]")||A,A.focus({preventScroll:!0}))})}function p(A){if(r=t.noRefocus===!1?document.activeElement:null,br(V),x(),I(),s=void 0,A!==void 0&&(t.touchPosition||t.contextMenu)){const le=hs(A);if(le.left!==void 0){const{top:Oe,left:je}=D.value.getBoundingClientRect();s={left:le.left-je,top:le.top-Oe}}}o===void 0&&(o=Z(()=>u.screen.width+"|"+u.screen.height+"|"+t.self+"|"+t.anchor+"|"+u.lang.rtl,F)),t.noFocus!==!0&&document.activeElement.blur(),C(()=>{F(),t.noFocus!==!0&&ie()}),M(()=>{u.platform.is.ios===!0&&(a=t.autoClose,h.value.click()),F(),x(!0),n("show",A)},t.transitionDuration)}function _(A){y(),P(),m(!0),r!==null&&(A===void 0||A.qClickOutside!==!0)&&(((A&&A.type.indexOf("key")===0?r.closest('[tabindex]:not([tabindex^="-"])'):void 0)||r).focus(),r=null),M(()=>{P(!0),n("hide",A)},t.transitionDuration)}function m(A){s=void 0,o!==void 0&&(o(),o=void 0),(A===!0||v.value===!0)&&(On(V),U(),pi(H),Qt(q)),A!==!0&&(r=null)}function I(){(D.value!==null||t.scrollTarget!==void 0)&&(O.value=Ss(D.value,t.scrollTarget),j(O.value,F))}function G(A){a!==!0?(no(c,A),n("click",A)):a=!1}function V(A){K.value===!0&&t.noFocus!==!0&&Xi(h.value,A.target)!==!0&&ie()}function q(A){n("escapeKey"),b(A)}function F(){wr({targetEl:h.value,offset:t.offset,anchorEl:D.value,anchorOrigin:N.value,selfOrigin:J.value,absoluteOffset:s,fit:t.fit,cover:t.cover,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function re(){return R(Jt,E.value,()=>v.value===!0?R("div",{role:"menu",...i,ref:h,tabindex:-1,class:["q-menu q-position-engine scroll"+B.value,i.class],style:[i.style,k.value],...w.value},Ce(e.default)):null)}return pe(m),Object.assign(c,{focus:ie,updatePosition:F}),T}});function vo(t,e,n){let i;function r(){i!==void 0&&(ai.remove(i),i=void 0)}return pe(()=>{t.value===!0&&r()}),{removeFromHistory:r,addToHistory(){i={condition:()=>n.value===!0,handler:e},ai.add(i)}}}let ft=0,pn,yn,yt,bn=!1,ki,xi,Ci,Me=null;function mo(t){go(t)&&ge(t)}function go(t){if(t.target===document.body||t.target.classList.contains("q-layout__backdrop"))return!0;const e=fs(t),n=t.shiftKey&&!t.deltaX,i=!n&&Math.abs(t.deltaX)<=Math.abs(t.deltaY),r=n||i?t.deltaY:t.deltaX;for(let s=0;s<e.length;s++){const o=e[s];if(Cs(o,i))return i?r<0&&o.scrollTop===0?!0:r>0&&o.scrollTop+o.clientHeight===o.scrollHeight:r<0&&o.scrollLeft===0?!0:r>0&&o.scrollLeft+o.clientWidth===o.scrollWidth}return!0}function Ti(t){t.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function zt(t){bn!==!0&&(bn=!0,requestAnimationFrame(()=>{bn=!1;const{height:e}=t.target,{clientHeight:n,scrollTop:i}=document.scrollingElement;(yt===void 0||e!==window.innerHeight)&&(yt=n-e,document.scrollingElement.scrollTop=i),i>yt&&(document.scrollingElement.scrollTop-=Math.ceil((i-yt)/8))}))}function Ei(t){const e=document.body,n=window.visualViewport!==void 0;if(t==="add"){const{overflowY:i,overflowX:r}=window.getComputedStyle(e);pn=ks(window),yn=xs(window),ki=e.style.left,xi=e.style.top,Ci=window.location.href,e.style.left=`-${pn}px`,e.style.top=`-${yn}px`,r!=="hidden"&&(r==="scroll"||e.scrollWidth>window.innerWidth)&&e.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||e.scrollHeight>window.innerHeight)&&e.classList.add("q-body--force-scrollbar-y"),e.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,Te.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",zt,ke.passiveCapture),window.visualViewport.addEventListener("scroll",zt,ke.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Ti,ke.passiveCapture))}Te.is.desktop===!0&&Te.is.mac===!0&&window[`${t}EventListener`]("wheel",mo,ke.notPassive),t==="remove"&&(Te.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",zt,ke.passiveCapture),window.visualViewport.removeEventListener("scroll",zt,ke.passiveCapture)):window.removeEventListener("scroll",Ti,ke.passiveCapture)),e.classList.remove("q-body--prevent-scroll"),e.classList.remove("q-body--force-scrollbar-x"),e.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,e.style.left=ki,e.style.top=xi,window.location.href===Ci&&window.scrollTo(pn,yn),yt=void 0)}function po(t){let e="add";if(t===!0){if(ft++,Me!==null){clearTimeout(Me),Me=null;return}if(ft>1)return}else{if(ft===0||(ft--,ft>0))return;if(e="remove",Te.is.ios===!0&&Te.is.nativeMobile===!0){Me!==null&&clearTimeout(Me),Me=setTimeout(()=>{Ei(e),Me=null},100);return}}Ei(e)}function yo(){let t;return{preventBodyScroll(e){e!==t&&(t!==void 0||e===!0)&&(t=e,po(e))}}}let Ht=0;const bo={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Oi={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var wo=_e({name:"QDialog",inheritAttrs:!1,props:{...lr,...hr,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:t=>t==="standard"||["top","bottom","left","right"].includes(t)}},emits:[...ur,"shake","click","escapeKey"],setup(t,{slots:e,emit:n,attrs:i}){const r=ce(),s=z(null),o=z(!1),a=z(!1);let l=null,c=null,u,h;const v=S(()=>t.persistent!==!0&&t.noRouteDismiss!==!0&&t.seamless!==!0),{preventBodyScroll:f}=yo(),{registerTimeout:g}=mr(),{registerTick:C,removeTick:y}=vr(),{transitionProps:M,transitionStyle:E}=fr(t,()=>Oi[t.position][0],()=>Oi[t.position][1]),{showPortal:k,hidePortal:O,portalIsAccessible:j,renderPortal:U}=dr(r,s,G,"dialog"),{hide:D}=cr({showing:o,hideOnRouteChange:v,handleShow:N,handleHide:J,processOnMount:!0}),{addToHistory:Q,removeFromHistory:b}=vo(o,D,v),x=S(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${t.maximized===!0?"maximized":"minimized"} q-dialog__inner--${t.position} ${bo[t.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(t.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(t.fullHeight===!0?" q-dialog__inner--fullheight":"")+(t.square===!0?" q-dialog__inner--square":"")),P=S(()=>o.value===!0&&t.seamless!==!0),T=S(()=>t.autoClose===!0?{onClick:_}:{}),H=S(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${P.value===!0?"modal":"seamless"}`,i.class]);Z(()=>t.maximized,V=>{o.value===!0&&p(V)}),Z(P,V=>{f(V),V===!0?(br(I),pr(K)):(On(I),Qt(K))});function N(V){Q(),c=t.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,p(t.maximized),k(),a.value=!0,t.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),C(B)):y(),g(()=>{if(r.proxy.$q.platform.is.ios===!0){if(t.seamless!==!0&&document.activeElement){const{top:q,bottom:F}=document.activeElement.getBoundingClientRect(),{innerHeight:re}=window,A=window.visualViewport!==void 0?window.visualViewport.height:re;q>0&&F>A/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-A,F>=re?1/0:Math.ceil(document.scrollingElement.scrollTop+F-A/2))),document.activeElement.scrollIntoView()}h=!0,s.value.click(),h=!1}k(!0),a.value=!1,n("show",V)},t.transitionDuration)}function J(V){y(),b(),ie(!0),a.value=!0,O(),c!==null&&(((V&&V.type.indexOf("key")===0?c.closest('[tabindex]:not([tabindex^="-"])'):void 0)||c).focus(),c=null),g(()=>{O(!0),a.value=!1,n("hide",V)},t.transitionDuration)}function B(V){Pt(()=>{let q=s.value;q===null||q.contains(document.activeElement)===!0||(q=(V!==""?q.querySelector(V):null)||q.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||q.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||q.querySelector("[autofocus], [data-autofocus]")||q,q.focus({preventScroll:!0}))})}function w(V){V&&typeof V.focus=="function"?V.focus({preventScroll:!0}):B(),n("shake");const q=s.value;q!==null&&(q.classList.remove("q-animate--scale"),q.classList.add("q-animate--scale"),l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,s.value!==null&&(q.classList.remove("q-animate--scale"),B())},170))}function K(){t.seamless!==!0&&(t.persistent===!0||t.noEscDismiss===!0?t.maximized!==!0&&t.noShake!==!0&&w():(n("escapeKey"),D()))}function ie(V){l!==null&&(clearTimeout(l),l=null),(V===!0||o.value===!0)&&(p(!1),t.seamless!==!0&&(f(!1),On(I),Qt(K))),V!==!0&&(c=null)}function p(V){V===!0?u!==!0&&(Ht<1&&document.body.classList.add("q-body--dialog"),Ht++,u=!0):u===!0&&(Ht<2&&document.body.classList.remove("q-body--dialog"),Ht--,u=!1)}function _(V){h!==!0&&(D(V),n("click",V))}function m(V){t.persistent!==!0&&t.noBackdropDismiss!==!0?D(V):t.noShake!==!0&&w()}function I(V){t.allowFocusOutside!==!0&&j.value===!0&&Xi(s.value,V.target)!==!0&&B('[tabindex]:not([tabindex="-1"])')}Object.assign(r.proxy,{focus:B,shake:w,__updateRefocusTarget(V){c=V||null}}),pe(ie);function G(){return R("div",{role:"dialog","aria-modal":P.value===!0?"true":"false",...i,class:H.value},[R(Jt,{name:"q-transition--fade",appear:!0},()=>P.value===!0?R("div",{class:"q-dialog__backdrop fixed-full",style:E.value,"aria-hidden":"true",tabindex:-1,onClick:m}):null),R(Jt,M.value,()=>o.value===!0?R("div",{ref:s,class:x.value,style:E.value,tabindex:-1,...T.value},Ce(e.default)):null)])}return U}});let Zt=!1;{const t=document.createElement("div");t.setAttribute("dir","rtl"),Object.assign(t.style,{width:"1px",height:"1px",overflow:"auto"});const e=document.createElement("div");Object.assign(e.style,{width:"1000px",height:"1px"}),document.body.appendChild(t),t.appendChild(e),t.scrollLeft=-1e3,Zt=t.scrollLeft>=0,t.remove()}const we=1e3,_o=["start","center","end","start-force","center-force","end-force"],_r=Array.prototype.filter,So=window.getComputedStyle(document.body).overflowAnchor===void 0?vs:function(t,e){t!==null&&(t._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(t._qOverflowAnimationFrame),t._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(t===null)return;t._qOverflowAnimationFrame=void 0;const n=t.children||[];_r.call(n,r=>r.dataset&&r.dataset.qVsAnchor!==void 0).forEach(r=>{delete r.dataset.qVsAnchor});const i=n[e];i&&i.dataset&&(i.dataset.qVsAnchor="")}))};function st(t,e){return t+e}function wn(t,e,n,i,r,s,o,a){const l=t===window?document.scrollingElement||document.documentElement:t,c=r===!0?"offsetWidth":"offsetHeight",u={scrollStart:0,scrollViewSize:-o-a,scrollMaxSize:0,offsetStart:-o,offsetEnd:-a};if(r===!0?(t===window?(u.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,u.scrollViewSize+=document.documentElement.clientWidth):(u.scrollStart=l.scrollLeft,u.scrollViewSize+=l.clientWidth),u.scrollMaxSize=l.scrollWidth,s===!0&&(u.scrollStart=(Zt===!0?u.scrollMaxSize-u.scrollViewSize:0)-u.scrollStart)):(t===window?(u.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,u.scrollViewSize+=document.documentElement.clientHeight):(u.scrollStart=l.scrollTop,u.scrollViewSize+=l.clientHeight),u.scrollMaxSize=l.scrollHeight),n!==null)for(let h=n.previousElementSibling;h!==null;h=h.previousElementSibling)h.classList.contains("q-virtual-scroll--skip")===!1&&(u.offsetStart+=h[c]);if(i!==null)for(let h=i.nextElementSibling;h!==null;h=h.nextElementSibling)h.classList.contains("q-virtual-scroll--skip")===!1&&(u.offsetEnd+=h[c]);if(e!==t){const h=l.getBoundingClientRect(),v=e.getBoundingClientRect();r===!0?(u.offsetStart+=v.left-h.left,u.offsetEnd-=v.width):(u.offsetStart+=v.top-h.top,u.offsetEnd-=v.height),t!==window&&(u.offsetStart+=u.scrollStart),u.offsetEnd+=u.scrollMaxSize-u.offsetStart}return u}function Ai(t,e,n,i){e==="end"&&(e=(t===window?document.body:t)[n===!0?"scrollWidth":"scrollHeight"]),t===window?n===!0?(i===!0&&(e=(Zt===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-e),window.scrollTo(e,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,e):n===!0?(i===!0&&(e=(Zt===!0?t.scrollWidth-t.offsetWidth:0)-e),t.scrollLeft=e):t.scrollTop=e}function vt(t,e,n,i){if(n>=i)return 0;const r=e.length,s=Math.floor(n/we),o=Math.floor((i-1)/we)+1;let a=t.slice(s,o).reduce(st,0);return n%we!==0&&(a-=e.slice(s*we,n).reduce(st,0)),i%we!==0&&i!==r&&(a-=e.slice(i,o*we).reduce(st,0)),a}const ko={virtualScrollSliceSize:{type:[Number,String],default:null},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},xo={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...ko};function Co({virtualScrollLength:t,getVirtualScrollTarget:e,getVirtualScrollEl:n,virtualScrollItemSizeComputed:i}){const r=ce(),{props:s,emit:o,proxy:a}=r,{$q:l}=a;let c,u,h,v=[],f;const g=z(0),C=z(0),y=z({}),M=z(null),E=z(null),k=z(null),O=z({from:0,to:0}),j=S(()=>s.tableColspan!==void 0?s.tableColspan:100);i===void 0&&(i=S(()=>s.virtualScrollItemSize));const U=S(()=>i.value+";"+s.virtualScrollHorizontal),D=S(()=>U.value+";"+s.virtualScrollSliceRatioBefore+";"+s.virtualScrollSliceRatioAfter);Z(D,()=>{B()}),Z(U,Q);function Q(){J(u,!0)}function b(_){J(_===void 0?u:_)}function x(_,m){const I=e();if(I==null||I.nodeType===8)return;const G=wn(I,n(),M.value,E.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd);h!==G.scrollViewSize&&B(G.scrollViewSize),T(I,G,Math.min(t.value-1,Math.max(0,parseInt(_,10)||0)),0,_o.indexOf(m)>-1?m:u>-1&&_>u?"end":"start")}function P(){const _=e();if(_==null||_.nodeType===8)return;const m=wn(_,n(),M.value,E.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd),I=t.value-1,G=m.scrollMaxSize-m.offsetStart-m.offsetEnd-C.value;if(c===m.scrollStart)return;if(m.scrollMaxSize<=0){T(_,m,0,0);return}h!==m.scrollViewSize&&B(m.scrollViewSize),H(O.value.from);const V=Math.floor(m.scrollMaxSize-Math.max(m.scrollViewSize,m.offsetEnd)-Math.min(f[I],m.scrollViewSize/2));if(V>0&&Math.ceil(m.scrollStart)>=V){T(_,m,I,m.scrollMaxSize-m.offsetEnd-v.reduce(st,0));return}let q=0,F=m.scrollStart-m.offsetStart,re=F;if(F<=G&&F+m.scrollViewSize>=g.value)F-=g.value,q=O.value.from,re=F;else for(let A=0;F>=v[A]&&q<I;A++)F-=v[A],q+=we;for(;F>0&&q<I;)F-=f[q],F>-m.scrollViewSize?(q++,re=F):re=f[q]+F;T(_,m,q,re)}function T(_,m,I,G,V){const q=typeof V=="string"&&V.indexOf("-force")>-1,F=q===!0?V.replace("-force",""):V,re=F!==void 0?F:"start";let A=Math.max(0,I-y.value[re]),le=A+y.value.total;le>t.value&&(le=t.value,A=Math.max(0,le-y.value.total)),c=m.scrollStart;const Oe=A!==O.value.from||le!==O.value.to;if(Oe===!1&&F===void 0){K(I);return}const{activeElement:je}=document,Se=k.value;Oe===!0&&Se!==null&&Se!==je&&Se.contains(je)===!0&&(Se.addEventListener("focusout",N),setTimeout(()=>{Se!==null&&Se.removeEventListener("focusout",N)})),So(Se,I-A);const jt=F!==void 0?f.slice(A,I).reduce(st,0):0;if(Oe===!0){const Ie=le>=O.value.from&&A<=O.value.to?O.value.to:le;O.value={from:A,to:Ie},g.value=vt(v,f,0,A),C.value=vt(v,f,le,t.value),requestAnimationFrame(()=>{O.value.to!==le&&c===m.scrollStart&&(O.value={from:O.value.from,to:le},C.value=vt(v,f,le,t.value))})}requestAnimationFrame(()=>{if(c!==m.scrollStart)return;Oe===!0&&H(A);const Ie=f.slice(A,I).reduce(st,0),Ke=Ie+m.offsetStart+g.value,It=Ke+f[I];let ct=Ke+G;if(F!==void 0){const an=Ie-jt,fe=m.scrollStart+an;ct=q!==!0&&fe<Ke&&It<fe+m.scrollViewSize?fe:F==="end"?It-m.scrollViewSize:Ke-(F==="start"?0:Math.round((m.scrollViewSize-f[I])/2))}c=ct,Ai(_,ct,s.virtualScrollHorizontal,l.lang.rtl),K(I)})}function H(_){const m=k.value;if(m){const I=_r.call(m.children,A=>A.classList&&A.classList.contains("q-virtual-scroll--skip")===!1),G=I.length,V=s.virtualScrollHorizontal===!0?A=>A.getBoundingClientRect().width:A=>A.offsetHeight;let q=_,F,re;for(let A=0;A<G;){for(F=V(I[A]),A++;A<G&&I[A].classList.contains("q-virtual-scroll--with-prev")===!0;)F+=V(I[A]),A++;re=F-f[q],re!==0&&(f[q]+=re,v[Math.floor(q/we)]+=re),q++}}}function N(){k.value!==null&&k.value!==void 0&&k.value.focus()}function J(_,m){const I=1*i.value;(m===!0||Array.isArray(f)===!1)&&(f=[]);const G=f.length;f.length=t.value;for(let q=t.value-1;q>=G;q--)f[q]=I;const V=Math.floor((t.value-1)/we);v=[];for(let q=0;q<=V;q++){let F=0;const re=Math.min((q+1)*we,t.value);for(let A=q*we;A<re;A++)F+=f[A];v.push(F)}u=-1,c=void 0,g.value=vt(v,f,0,O.value.from),C.value=vt(v,f,O.value.to,t.value),_>=0?(H(O.value.from),ae(()=>{x(_)})):ie()}function B(_){if(_===void 0&&typeof window!="undefined"){const F=e();F!=null&&F.nodeType!==8&&(_=wn(F,n(),M.value,E.value,s.virtualScrollHorizontal,l.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd).scrollViewSize)}h=_;const m=parseFloat(s.virtualScrollSliceRatioBefore)||0,I=parseFloat(s.virtualScrollSliceRatioAfter)||0,G=1+m+I,V=_===void 0||_<=0?1:Math.ceil(_/i.value),q=Math.max(1,V,Math.ceil((s.virtualScrollSliceSize>0?s.virtualScrollSliceSize:10)/G));y.value={total:Math.ceil(q*G),start:Math.ceil(q*m),center:Math.ceil(q*(.5+m)),end:Math.ceil(q*(1+m)),view:V}}function w(_,m){const I=s.virtualScrollHorizontal===!0?"width":"height",G={["--q-virtual-scroll-item-"+I]:i.value+"px"};return[_==="tbody"?R(_,{class:"q-virtual-scroll__padding",key:"before",ref:M},[R("tr",[R("td",{style:{[I]:`${g.value}px`,...G},colspan:j.value})])]):R(_,{class:"q-virtual-scroll__padding",key:"before",ref:M,style:{[I]:`${g.value}px`,...G}}),R(_,{class:"q-virtual-scroll__content",key:"content",ref:k,tabindex:-1},m.flat()),_==="tbody"?R(_,{class:"q-virtual-scroll__padding",key:"after",ref:E},[R("tr",[R("td",{style:{[I]:`${C.value}px`,...G},colspan:j.value})])]):R(_,{class:"q-virtual-scroll__padding",key:"after",ref:E,style:{[I]:`${C.value}px`,...G}})]}function K(_){u!==_&&(s.onVirtualScroll!==void 0&&o("virtualScroll",{index:_,from:O.value.from,to:O.value.to-1,direction:_<u?"decrease":"increase",ref:a}),u=_)}B();const ie=Gi(P,l.platform.is.ios===!0?120:35);ms(()=>{B()});let p=!1;return Rt(()=>{p=!0}),In(()=>{if(p!==!0)return;const _=e();c!==void 0&&_!==void 0&&_!==null&&_.nodeType!==8?Ai(_,c,s.virtualScrollHorizontal,l.lang.rtl):x(u)}),pe(()=>{ie.cancel()}),Object.assign(a,{scrollTo:x,reset:Q,refresh:b}),{virtualScrollSliceRange:O,virtualScrollSliceSizeComputed:y,setVirtualScrollSize:B,onVirtualScrollEvt:ie,localResetVirtualScroll:J,padVirtualScroll:w,scrollTo:x,reset:Q,refresh:b}}function Ri(t,e,n){if(n<=e)return e;const i=n-e+1;let r=e+(t-e)%i;return r<e&&(r=i+r),r===0?0:r}const $i=t=>["add","add-unique","toggle"].includes(t),To=".*+?^${}()|[]\\",Eo=Object.keys(rn);var Pi=_e({name:"QSelect",inheritAttrs:!1,props:{...xo,...sr,...rn,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:$i},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:t=>["default","menu","dialog"].includes(t),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...Vn,"add","remove","inputValue","newValue","keyup","keypress","keydown","filterAbort"],setup(t,{slots:e,emit:n}){const{proxy:i}=ce(),{$q:r}=i,s=z(!1),o=z(!1),a=z(-1),l=z(""),c=z(!1),u=z(!1);let h=null,v,f,g,C=null,y,M,E,k;const O=z(null),j=z(null),U=z(null),D=z(null),Q=z(null),b=or(t),x=ar(ti),P=S(()=>Array.isArray(t.options)?t.options.length:0),T=S(()=>t.virtualScrollItemSize===void 0?t.optionsDense===!0?24:48:t.virtualScrollItemSize),{virtualScrollSliceRange:H,virtualScrollSliceSizeComputed:N,localResetVirtualScroll:J,padVirtualScroll:B,onVirtualScrollEvt:w,scrollTo:K,setVirtualScrollSize:ie}=Co({virtualScrollLength:P,getVirtualScrollTarget:jr,getVirtualScrollEl:Zn,virtualScrollItemSizeComputed:T}),p=Mn(),_=S(()=>{const d=t.mapOptions===!0&&t.multiple!==!0,L=t.modelValue!==void 0&&(t.modelValue!==null||d===!0)?t.multiple===!0&&Array.isArray(t.modelValue)?t.modelValue:[t.modelValue]:[];if(t.mapOptions===!0&&Array.isArray(t.options)===!0){const $=t.mapOptions===!0&&v!==void 0?v:[],W=L.map(te=>qr(te,$));return t.modelValue===null&&d===!0?W.filter(te=>te!==null):W}return L}),m=S(()=>{const d={};return Eo.forEach(L=>{const $=t[L];$!==void 0&&(d[L]=$)}),d}),I=S(()=>t.optionsDark===null?p.isDark.value:t.optionsDark),G=S(()=>Tt(_.value)),V=S(()=>{let d="q-field__input q-placeholder col";return t.hideSelected===!0||_.value.length===0?[d,t.inputClass]:(d+=" q-field__input--padding",t.inputClass===void 0?d:[d,t.inputClass])}),q=S(()=>(t.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(t.popupContentClass?" "+t.popupContentClass:"")),F=S(()=>P.value===0),re=S(()=>_.value.map(d=>ve.value(d)).join(", ")),A=S(()=>t.displayValue!==void 0?t.displayValue:re.value),le=S(()=>t.optionsHtml===!0?()=>!0:d=>d!=null&&d.html===!0),Oe=S(()=>t.displayValueHtml===!0||t.displayValue===void 0&&(t.optionsHtml===!0||_.value.some(le.value))),je=S(()=>p.focused.value===!0?t.tabindex:-1),Se=S(()=>{const d={tabindex:t.tabindex,role:"combobox","aria-label":t.label,"aria-readonly":t.readonly===!0?"true":"false","aria-autocomplete":t.useInput===!0?"list":"none","aria-expanded":s.value===!0?"true":"false","aria-controls":`${p.targetUid.value}_lb`};return a.value>=0&&(d["aria-activedescendant"]=`${p.targetUid.value}_${a.value}`),d}),jt=S(()=>({id:`${p.targetUid.value}_lb`,role:"listbox","aria-multiselectable":t.multiple===!0?"true":"false"})),Ie=S(()=>_.value.map((d,L)=>({index:L,opt:d,html:le.value(d),selected:!0,removeAtIndex:Pr,toggleOption:Le,tabindex:je.value}))),Ke=S(()=>{if(P.value===0)return[];const{from:d,to:L}=H.value;return t.options.slice(d,L).map(($,W)=>{const te=We.value($)===!0,ee=d+W,se={clickable:!0,active:!1,activeClass:an.value,manualFocus:!0,focused:!1,disable:te,tabindex:-1,dense:t.optionsDense,dark:I.value,role:"option",id:`${p.targetUid.value}_${ee}`,onClick:()=>{Le($)}};return te!==!0&&(cn($)===!0&&(se.active=!0),a.value===ee&&(se.focused=!0),se["aria-selected"]=se.active===!0?"true":"false",r.platform.is.desktop===!0&&(se.onMousemove=()=>{s.value===!0&&Je(ee)})),{index:ee,opt:$,html:le.value($),label:ve.value($),selected:se.active,focused:se.focused,toggleOption:Le,setOptionIndex:Je,itemProps:se}})}),It=S(()=>t.dropdownIcon!==void 0?t.dropdownIcon:r.iconSet.arrow.dropdown),ct=S(()=>t.optionsCover===!1&&t.outlined!==!0&&t.standout!==!0&&t.borderless!==!0&&t.rounded!==!0),an=S(()=>t.optionsSelectedClass!==void 0?t.optionsSelectedClass:t.color!==void 0?`text-${t.color}`:""),fe=S(()=>un(t.optionValue,"value")),ve=S(()=>un(t.optionLabel,"label")),We=S(()=>un(t.optionDisable,"disable")),Lt=S(()=>_.value.map(d=>fe.value(d))),$r=S(()=>{const d={onInput:ti,onChange:x,onKeydown:Xn,onKeyup:Qn,onKeypress:Yn,onFocus:Jn,onClick(L){f===!0&&$e(L)}};return d.onCompositionstart=d.onCompositionupdate=d.onCompositionend=x,d});Z(_,d=>{v=d,t.useInput===!0&&t.fillInput===!0&&t.multiple!==!0&&p.innerLoading.value!==!0&&(o.value!==!0&&s.value!==!0||G.value!==!0)&&(g!==!0&&Xe(),(o.value===!0||s.value===!0)&&Ge(""))},{immediate:!0}),Z(()=>t.fillInput,Xe),Z(s,dn),Z(P,Kr);function Kn(d){return t.emitValue===!0?fe.value(d):d}function ln(d){if(d>-1&&d<_.value.length)if(t.multiple===!0){const L=t.modelValue.slice();n("remove",{index:d,value:L.splice(d,1)[0]}),n("update:modelValue",L)}else n("update:modelValue",null)}function Pr(d){ln(d),p.focus()}function Wn(d,L){const $=Kn(d);if(t.multiple!==!0){t.fillInput===!0&&dt(ve.value(d),!0,!0),n("update:modelValue",$);return}if(_.value.length===0){n("add",{index:0,value:$}),n("update:modelValue",t.multiple===!0?[$]:$);return}if(L===!0&&cn(d)===!0||t.maxValues!==void 0&&t.modelValue.length>=t.maxValues)return;const W=t.modelValue.slice();n("add",{index:W.length,value:$}),W.push($),n("update:modelValue",W)}function Le(d,L){if(p.editable.value!==!0||d===void 0||We.value(d)===!0)return;const $=fe.value(d);if(t.multiple!==!0){L!==!0&&(dt(t.fillInput===!0?ve.value(d):"",!0,!0),Ve()),j.value!==null&&j.value.focus(),(_.value.length===0||ht(fe.value(_.value[0]),$)!==!0)&&n("update:modelValue",t.emitValue===!0?$:d);return}if((f!==!0||c.value===!0)&&p.focus(),Jn(),_.value.length===0){const ee=t.emitValue===!0?$:d;n("add",{index:0,value:ee}),n("update:modelValue",t.multiple===!0?[ee]:ee);return}const W=t.modelValue.slice(),te=Lt.value.findIndex(ee=>ht(ee,$));if(te>-1)n("remove",{index:te,value:W.splice(te,1)[0]});else{if(t.maxValues!==void 0&&W.length>=t.maxValues)return;const ee=t.emitValue===!0?$:d;n("add",{index:W.length,value:ee}),W.push(ee)}n("update:modelValue",W)}function Je(d){if(r.platform.is.desktop!==!0)return;const L=d>-1&&d<P.value?d:-1;a.value!==L&&(a.value=L)}function Vt(d=1,L){if(s.value===!0){let $=a.value;do $=Ri($+d,-1,P.value-1);while($!==-1&&$!==a.value&&We.value(t.options[$])===!0);a.value!==$&&(Je($),K($),L!==!0&&t.useInput===!0&&t.fillInput===!0&&Mt($>=0?ve.value(t.options[$]):y))}}function qr(d,L){const $=W=>ht(fe.value(W),d);return t.options.find($)||L.find($)||d}function un(d,L){const $=d!==void 0?d:L;return typeof $=="function"?$:W=>W!==null&&typeof W=="object"&&$ in W?W[$]:W}function cn(d){const L=fe.value(d);return Lt.value.find($=>ht($,L))!==void 0}function Jn(d){t.useInput===!0&&j.value!==null&&(d===void 0||j.value===d.target&&d.target.value===re.value)&&j.value.select()}function Gn(d){en(d,27)===!0&&s.value===!0&&($e(d),Ve(),Xe()),n("keyup",d)}function Qn(d){const{value:L}=d.target;if(d.keyCode!==void 0){Gn(d);return}if(d.target.value="",h!==null&&(clearTimeout(h),h=null),Xe(),typeof L=="string"&&L.length!==0){const $=L.toLocaleLowerCase(),W=ee=>{const se=t.options.find(he=>ee.value(he).toLocaleLowerCase()===$);return se===void 0?!1:(_.value.indexOf(se)===-1?Le(se):Ve(),!0)},te=ee=>{W(fe)!==!0&&(W(ve)===!0||ee===!0||Ge(L,!0,()=>te(!0)))};te()}else p.clearValue(d)}function Yn(d){n("keypress",d)}function Xn(d){if(n("keydown",d),Yi(d)===!0)return;const L=l.value.length!==0&&(t.newValueMode!==void 0||t.onNewValue!==void 0),$=d.shiftKey!==!0&&t.multiple!==!0&&(a.value>-1||L===!0);if(d.keyCode===27){xe(d);return}if(d.keyCode===9&&$===!1){Qe();return}if(d.target===void 0||d.target.id!==p.targetUid.value||p.editable.value!==!0)return;if(d.keyCode===40&&p.innerLoading.value!==!0&&s.value===!1){ge(d),Ye();return}if(d.keyCode===8&&t.hideSelected!==!0&&l.value.length===0){t.multiple===!0&&Array.isArray(t.modelValue)===!0?ln(t.modelValue.length-1):t.multiple!==!0&&t.modelValue!==null&&n("update:modelValue",null);return}(d.keyCode===35||d.keyCode===36)&&(typeof l.value!="string"||l.value.length===0)&&(ge(d),a.value=-1,Vt(d.keyCode===36?1:-1,t.multiple)),(d.keyCode===33||d.keyCode===34)&&N.value!==void 0&&(ge(d),a.value=Math.max(-1,Math.min(P.value,a.value+(d.keyCode===33?-1:1)*N.value.view)),Vt(d.keyCode===33?1:-1,t.multiple)),(d.keyCode===38||d.keyCode===40)&&(ge(d),Vt(d.keyCode===38?-1:1,t.multiple));const W=P.value;if((E===void 0||k<Date.now())&&(E=""),W>0&&t.useInput!==!0&&d.key!==void 0&&d.key.length===1&&d.altKey===!1&&d.ctrlKey===!1&&d.metaKey===!1&&(d.keyCode!==32||E.length!==0)){s.value!==!0&&Ye(d);const te=d.key.toLocaleLowerCase(),ee=E.length===1&&E[0]===te;k=Date.now()+1500,ee===!1&&(ge(d),E+=te);const se=new RegExp("^"+E.split("").map(hn=>To.indexOf(hn)>-1?"\\"+hn:hn).join(".*"),"i");let he=a.value;if(ee===!0||he<0||se.test(ve.value(t.options[he]))!==!0)do he=Ri(he+1,-1,W-1);while(he!==a.value&&(We.value(t.options[he])===!0||se.test(ve.value(t.options[he]))!==!0));a.value!==he&&ae(()=>{Je(he),K(he),he>=0&&t.useInput===!0&&t.fillInput===!0&&Mt(ve.value(t.options[he]))});return}if(!(d.keyCode!==13&&(d.keyCode!==32||t.useInput===!0||E!=="")&&(d.keyCode!==9||$===!1))){if(d.keyCode!==9&&ge(d),a.value>-1&&a.value<W){Le(t.options[a.value]);return}if(L===!0){const te=(ee,se)=>{if(se){if($i(se)!==!0)return}else se=t.newValueMode;if(dt("",t.multiple!==!0,!0),ee==null)return;(se==="toggle"?Le:Wn)(ee,se==="add-unique"),t.multiple!==!0&&(j.value!==null&&j.value.focus(),Ve())};if(t.onNewValue!==void 0?n("newValue",l.value,te):te(l.value),t.multiple!==!0)return}s.value===!0?Qe():p.innerLoading.value!==!0&&Ye()}}function Zn(){return f===!0?Q.value:U.value!==null&&U.value.contentEl!==null?U.value.contentEl:void 0}function jr(){return Zn()}function Ir(){return t.hideSelected===!0?[]:e["selected-item"]!==void 0?Ie.value.map(d=>e["selected-item"](d)).slice():e.selected!==void 0?[].concat(e.selected()):t.useChips===!0?Ie.value.map((d,L)=>R(Js,{key:"option-"+L,removable:p.editable.value===!0&&We.value(d.opt)!==!0,dense:!0,textColor:t.color,tabindex:je.value,onRemove(){d.removeAtIndex(L)}},()=>R("span",{class:"ellipsis",[d.html===!0?"innerHTML":"textContent"]:ve.value(d.opt)}))):[R("span",{[Oe.value===!0?"innerHTML":"textContent"]:A.value})]}function ei(){if(F.value===!0)return e["no-option"]!==void 0?e["no-option"]({inputValue:l.value}):void 0;const d=e.option!==void 0?e.option:$=>R(Gs,{key:$.index,...$.itemProps},()=>R(Qs,()=>R(Ys,()=>R("span",{[$.html===!0?"innerHTML":"textContent"]:$.label}))));let L=B("div",Ke.value.map(d));return e["before-options"]!==void 0&&(L=e["before-options"]().concat(L)),ps(e["after-options"],L)}function Lr(d,L){const $=L===!0?{...Se.value,...p.splitAttrs.attributes.value}:void 0,W={ref:L===!0?j:void 0,key:"i_t",class:V.value,style:t.inputStyle,value:l.value!==void 0?l.value:"",type:"search",...$,id:L===!0?p.targetUid.value:void 0,maxlength:t.maxlength,autocomplete:t.autocomplete,"data-autofocus":d===!0||t.autofocus===!0||void 0,disabled:t.disable===!0,readonly:t.readonly===!0,...$r.value};return d!==!0&&f===!0&&(Array.isArray(W.class)===!0?W.class=[...W.class,"no-pointer-events"]:W.class+=" no-pointer-events"),R("input",W)}function ti(d){h!==null&&(clearTimeout(h),h=null),!(d&&d.target&&d.target.qComposing===!0)&&(Mt(d.target.value||""),g=!0,y=l.value,p.focused.value!==!0&&(f!==!0||c.value===!0)&&p.focus(),t.onFilter!==void 0&&(h=setTimeout(()=>{h=null,Ge(l.value)},t.inputDebounce)))}function Mt(d){l.value!==d&&(l.value=d,n("inputValue",d))}function dt(d,L,$){g=$!==!0,t.useInput===!0&&(Mt(d),(L===!0||$!==!0)&&(y=d),L!==!0&&Ge(d))}function Ge(d,L,$){if(t.onFilter===void 0||L!==!0&&p.focused.value!==!0)return;p.innerLoading.value===!0?n("filterAbort"):(p.innerLoading.value=!0,u.value=!0),d!==""&&t.multiple!==!0&&_.value.length!==0&&g!==!0&&d===ve.value(_.value[0])&&(d="");const W=setTimeout(()=>{s.value===!0&&(s.value=!1)},10);C!==null&&clearTimeout(C),C=W,n("filter",d,(te,ee)=>{(L===!0||p.focused.value===!0)&&C===W&&(clearTimeout(C),typeof te=="function"&&te(),u.value=!1,ae(()=>{p.innerLoading.value=!1,p.editable.value===!0&&(L===!0?s.value===!0&&Ve():s.value===!0?dn(!0):s.value=!0),typeof ee=="function"&&ae(()=>{ee(i)}),typeof $=="function"&&ae(()=>{$(i)})}))},()=>{p.focused.value===!0&&C===W&&(clearTimeout(C),p.innerLoading.value=!1,u.value=!1),s.value===!0&&(s.value=!1)})}function Vr(){return R(fo,{ref:U,class:q.value,style:t.popupContentStyle,modelValue:s.value,fit:t.menuShrink!==!0,cover:t.optionsCover===!0&&F.value!==!0&&t.useInput!==!0,anchor:t.menuAnchor,self:t.menuSelf,offset:t.menuOffset,dark:I.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,square:ct.value,transitionShow:t.transitionShow,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,separateClosePopup:!0,...jt.value,onScrollPassive:w,onBeforeShow:ii,onBeforeHide:Mr,onShow:Fr},ei)}function Mr(d){ri(d),Qe()}function Fr(){ie()}function Dr(d){$e(d),j.value!==null&&j.value.focus(),c.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Br(d){$e(d),ae(()=>{c.value=!1})}function Ur(){const d=[R(Ks,{class:`col-auto ${p.fieldClass.value}`,...m.value,for:p.targetUid.value,dark:I.value,square:!0,loading:u.value,itemAligned:!1,filled:!0,stackLabel:l.value.length!==0,...p.splitAttrs.listeners.value,onFocus:Dr,onBlur:Br},{...e,rawControl:()=>p.getControl(!0),before:void 0,after:void 0})];return s.value===!0&&d.push(R("div",{ref:Q,class:q.value+" scroll",style:t.popupContentStyle,...jt.value,onClick:xe,onScrollPassive:w},ei())),R(wo,{ref:D,modelValue:o.value,position:t.useInput===!0?"top":void 0,transitionShow:M,transitionHide:t.transitionHide,transitionDuration:t.transitionDuration,onBeforeShow:ii,onBeforeHide:zr,onHide:Hr,onShow:Nr},()=>R("div",{class:"q-select__dialog"+(I.value===!0?" q-select__dialog--dark q-dark":"")+(c.value===!0?" q-select__dialog--focused":"")},d))}function zr(d){ri(d),D.value!==null&&D.value.__updateRefocusTarget(p.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),p.focused.value=!1}function Hr(d){Ve(),p.focused.value===!1&&n("blur",d),Xe()}function Nr(){const d=document.activeElement;(d===null||d.id!==p.targetUid.value)&&j.value!==null&&j.value!==d&&j.value.focus(),ie()}function Qe(){o.value!==!0&&(a.value=-1,s.value===!0&&(s.value=!1),p.focused.value===!1&&(C!==null&&(clearTimeout(C),C=null),p.innerLoading.value===!0&&(n("filterAbort"),p.innerLoading.value=!1,u.value=!1)))}function Ye(d){p.editable.value===!0&&(f===!0?(p.onControlFocusin(d),o.value=!0,ae(()=>{p.focus()})):p.focus(),t.onFilter!==void 0?Ge(l.value):(F.value!==!0||e["no-option"]!==void 0)&&(s.value=!0))}function Ve(){o.value=!1,Qe()}function Xe(){t.useInput===!0&&dt(t.multiple!==!0&&t.fillInput===!0&&_.value.length!==0&&ve.value(_.value[0])||"",!0,!0)}function dn(d){let L=-1;if(d===!0){if(_.value.length!==0){const $=fe.value(_.value[0]);L=t.options.findIndex(W=>ht(fe.value(W),$))}J(L)}Je(L)}function Kr(d,L){s.value===!0&&p.innerLoading.value===!1&&(J(-1,!0),ae(()=>{s.value===!0&&p.innerLoading.value===!1&&(d>L?J():dn(!0))}))}function ni(){o.value===!1&&U.value!==null&&U.value.updatePosition()}function ii(d){d!==void 0&&$e(d),n("popupShow",d),p.hasPopupOpen=!0,p.onControlFocusin(d)}function ri(d){d!==void 0&&$e(d),n("popupHide",d),p.hasPopupOpen=!1,p.onControlFocusout(d)}function si(){f=r.platform.is.mobile!==!0&&t.behavior!=="dialog"?!1:t.behavior!=="menu"&&(t.useInput===!0?e["no-option"]!==void 0||t.onFilter!==void 0||F.value===!1:!0),M=r.platform.is.ios===!0&&f===!0&&t.useInput===!0?"fade":t.transitionShow}return Qi(si),gs(ni),si(),pe(()=>{h!==null&&clearTimeout(h)}),Object.assign(i,{showPopup:Ye,hidePopup:Ve,removeAtIndex:ln,add:Wn,toggleOption:Le,getOptionIndex:()=>a.value,setOptionIndex:Je,moveOptionSelection:Vt,filter:Ge,updateMenuPosition:ni,updateInputValue:dt,isOptionSelected:cn,getEmittingOptionValue:Kn,isOptionDisabled:(...d)=>We.value.apply(null,d)===!0,getOptionValue:(...d)=>fe.value.apply(null,d),getOptionLabel:(...d)=>ve.value.apply(null,d)}),Object.assign(p,{innerValue:_,fieldClass:S(()=>`q-select q-field--auto-height q-select--with${t.useInput!==!0?"out":""}-input q-select--with${t.useChips!==!0?"out":""}-chips q-select--${t.multiple===!0?"multiple":"single"}`),inputRef:O,targetRef:j,hasValue:G,showPopup:Ye,floatingLabel:S(()=>t.hideSelected!==!0&&G.value===!0||typeof l.value=="number"||l.value.length!==0||Tt(t.displayValue)),getControlChild:()=>{if(p.editable.value!==!1&&(o.value===!0||F.value!==!0||e["no-option"]!==void 0))return f===!0?Ur():Vr();p.hasPopupOpen===!0&&(p.hasPopupOpen=!1)},controlEvents:{onFocusin(d){p.onControlFocusin(d)},onFocusout(d){p.onControlFocusout(d,()=>{Xe(),Qe()})},onClick(d){if(xe(d),f!==!0&&s.value===!0){Qe(),j.value!==null&&j.value.focus();return}Ye(d)}},getControl:d=>{const L=Ir(),$=d===!0||o.value!==!0||f!==!0;if(t.useInput===!0)L.push(Lr(d,$));else if(p.editable.value===!0){const te=$===!0?Se.value:void 0;L.push(R("input",{ref:$===!0?j:void 0,key:"d_t",class:"q-select__focus-target",id:$===!0?p.targetUid.value:void 0,value:A.value,readonly:!0,"data-autofocus":d===!0||t.autofocus===!0||void 0,...te,onKeydown:Xn,onKeyup:Gn,onKeypress:Yn})),$===!0&&typeof t.autocomplete=="string"&&t.autocomplete.length!==0&&L.push(R("input",{class:"q-select__autocomplete-input",autocomplete:t.autocomplete,tabindex:-1,onKeyup:Qn}))}if(b.value!==void 0&&t.disable!==!0&&Lt.value.length!==0){const te=Lt.value.map(ee=>R("option",{value:ee,selected:!0}));L.push(R("select",{class:"hidden",name:b.value,multiple:t.multiple},te))}const W=t.useInput===!0||$!==!0?void 0:p.splitAttrs.attributes.value;return R("div",{class:"q-field__native row items-center",...W,...p.splitAttrs.listeners.value},L)},getInnerAppend:()=>t.loading!==!0&&u.value!==!0&&t.hideDropdownIcon!==!0?[R(rt,{class:"q-select__dropdown-icon"+(s.value===!0?" rotate-180":""),name:It.value})]:null}),Fn(p)}});const Oo=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...n)=>$t(()=>Promise.resolve().then(function(){return qt}),void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)};class Dn extends Error{constructor(e,n="FunctionsError",i){super(e),this.name=n,this.context=i}}class Ao extends Dn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ro extends Dn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class $o extends Dn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Po=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};class qo{constructor(e,{headers:n={},customFetch:i}={}){this.url=e,this.headers=n,this.fetch=Oo(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var i;return Po(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let a={},l;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob!="undefined"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",l=o):typeof o=="string"?(a["Content-Type"]="text/plain",l=o):typeof FormData!="undefined"&&o instanceof FormData?l=o:(a["Content-Type"]="application/json",l=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),r),body:l}).catch(f=>{throw new Ao(f)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new Ro(c);if(!c.ok)throw new $o(c);let h=((i=c.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),v;return h==="application/json"?v=yield c.json():h==="application/octet-stream"?v=yield c.blob():h==="multipart/form-data"?v=yield c.formData():v=yield c.text(),{data:v,error:null}}catch(r){return{data:null,error:r}}})}}var qi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Et={exports:{}};(function(t,e){var n=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof qi!="undefined")return qi;throw new Error("unable to locate global object")},i=n();t.exports=e=i.fetch,i.fetch&&(e.default=i.fetch.bind(i)),e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response})(Et,Et.exports);var Bn=Et.exports,qt=Es({__proto__:null,default:Bn},[Et.exports]);class jo{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch=="undefined"?this.fetch=Bn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let c=null,u=null,h=null,v=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const M=await s.text();M===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=M:u=JSON.parse(M))}const C=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");C&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,v=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const C=await s.text();try{c=JSON.parse(C),Array.isArray(c)&&s.status===404&&(u=[],c=null,v=200,f="OK")}catch{s.status===404&&C===""?(v=204,f="No Content"):c={message:C}}if(c&&this.isMaybeSingle&&((l=c==null?void 0:c.details)===null||l===void 0?void 0:l.includes("0 rows"))&&(c=null,v=200,f="OK"),c&&this.shouldThrowOnError)throw c}return{error:c,data:u,count:h,status:v,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class Io extends jo{select(e){let n=!1;const i=(e!=null?e:"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:i,foreignTable:r}={}){const s=r?`${r}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${n?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n}={}){const i=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:i}={}){const r=typeof i=="undefined"?"offset":`${i}.offset`,s=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(s,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){const a=[e?"analyze":null,n?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${l}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class it extends Io{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const i=n.map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${i})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:i,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=i===void 0?"":`(${i})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,i])=>{this.url.searchParams.append(n,`eq.${i}`)}),this}not(e,n,i){return this.url.searchParams.append(e,`not.${n}.${i}`),this}or(e,{foreignTable:n}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,i){return this.url.searchParams.append(e,`${n}.${i}`),this}}class Lo{constructor(e,{headers:n={},schema:i,fetch:r}){this.url=e,this.headers=n,this.schema=i,this.fetch=r}select(e,{head:n=!1,count:i}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e!=null?e:"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),i&&(this.headers.Prefer=`count=${i}`),new it({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:i=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),i||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new it({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:i=!1,count:r,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${i?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new it({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const i="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new it({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",i=[];return e&&i.push(`count=${e}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new it({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Vo="1.8.5",Mo={"X-Client-Info":`postgrest-js/${Vo}`};class Un{constructor(e,{headers:n={},schema:i,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Mo),n),this.schemaName=i,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new Lo(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Un(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:i=!1,count:r}={}){let s;const o=new URL(`${this.url}/rpc/${e}`);let a;i?(s="HEAD",Object.entries(n).forEach(([c,u])=>{o.searchParams.append(c,`${u}`)})):(s="POST",a=n);const l=Object.assign({},this.headers);return r&&(l.Prefer=`count=${r}`),new it({method:s,url:o,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Fo="websocket",Do="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Bo=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Uo="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",zo=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Ho="1.0.34",No={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Ko="https://github.com/theturtle32/WebSocket-Node",Wo={node:">=4.0.0"},Jo={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Go={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Qo={verbose:!1},Yo={test:"tape test/unit/*.js",gulp:"gulp"},Xo="index",Zo={lib:"./lib"},ea="lib/browser.js",ta="Apache-2.0";var na={name:Fo,description:Do,keywords:Bo,author:Uo,contributors:zo,version:Ho,repository:No,homepage:Ko,engines:Wo,dependencies:Jo,devDependencies:Go,config:Qo,scripts:Yo,main:Xo,directories:Zo,browser:ea,license:ta},ia=na.version,De;if(typeof globalThis=="object")De=globalThis;else try{De=require("es5-ext/global")}catch{}finally{if(!De&&typeof window!="undefined"&&(De=window),!De)throw new Error("Could not determine global this")}var Ot=De.WebSocket||De.MozWebSocket,ra=ia;function Sr(t,e){var n;return e?n=new Ot(t,e):n=new Ot(t),n}Ot&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(Sr,t,{get:function(){return Ot[t]}})});var sa={w3cwebsocket:Ot?Sr:null,version:ra};const oa="2.8.0",aa={"X-Client-Info":`realtime-js/${oa}`},la="1.0.0",kr=1e4,ua=1e3;var St;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(St||(St={}));var me;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(me||(me={}));var be;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(be||(be={}));var Rn;(function(t){t.websocket="websocket"})(Rn||(Rn={}));var Be;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Be||(Be={}));class xr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ca{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,n,i)}_decodeBroadcast(e,n,i){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=i.decode(e.slice(o,o+r));o=o+r;const l=i.decode(e.slice(o,o+s));o=o+s;const c=JSON.parse(i.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class _n{constructor(e,n,i={},r=kr){this.channel=e,this.event=n,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var i;return this._hasReceived(e)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ji;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ji||(ji={}));class kt{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=kt.syncState(this.state,r,s,o),this.pendingDiffs.forEach(l=>{this.state=kt.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(i.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=kt.syncDiff(this.state,r,s,o),a())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,i,r){const s=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(s,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=s[c];if(h){const v=u.map(y=>y.presence_ref),f=h.map(y=>y.presence_ref),g=u.filter(y=>f.indexOf(y.presence_ref)<0),C=h.filter(y=>v.indexOf(y.presence_ref)<0);g.length>0&&(a[c]=g),C.length>0&&(l[c]=C)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},i,r)}static syncDiff(e,n,i,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),v=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...v)}i(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,r(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(i=>n(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,i)=>{const r=e[i];return"metas"in r?n[i]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[i]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ne;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ne||(ne={}));const Ii=(t,e,n={})=>{var i;const r=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((s,o)=>(s[o]=da(o,t,e,r),s),{})},da=(t,e,n,i)=>{const r=e.find(a=>a.name===t),s=r==null?void 0:r.type,o=n[t];return s&&!i.includes(s)?Cr(s,o):$n(o)},Cr=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return ma(e,n)}switch(t){case ne.bool:return ha(e);case ne.float4:case ne.float8:case ne.int2:case ne.int4:case ne.int8:case ne.numeric:case ne.oid:return fa(e);case ne.json:case ne.jsonb:return va(e);case ne.timestamp:return ga(e);case ne.abstime:case ne.date:case ne.daterange:case ne.int4range:case ne.int8range:case ne.money:case ne.reltime:case ne.text:case ne.time:case ne.timestamptz:case ne.timetz:case ne.tsrange:case ne.tstzrange:return $n(e);default:return $n(e)}},$n=t=>t,ha=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},fa=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},va=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ma=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,i=t[n];if(t[0]==="{"&&i==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>Cr(e,a))}return t},ga=t=>typeof t=="string"?t.replace(" ","T"):t;var Li;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Li||(Li={}));var Vi;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(Vi||(Vi={}));var Mi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Mi||(Mi={}));class zn{constructor(e,n={config:{}},i){this.topic=e,this.params=n,this.socket=i,this.bindings={},this.state=me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new _n(this,be.join,this.params,this.timeout),this.rejoinTimer=new xr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=me.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this._isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(be.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new kt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const a={},l={broadcast:s,presence:o,postgres_changes:(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(c=>c.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:c})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,v=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,f=[];for(let g=0;g<v;g++){const C=h[g],{filter:{event:y,schema:M,table:E,filter:k}}=C,O=c&&c[g];if(O&&O.event===y&&O.schema===M&&O.table===E&&O.filter===k)f.push(Object.assign(Object.assign({},C),{id:O.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,i){return this._on(e,n,i)}async send(e,n={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,a={method:"POST",headers:{apikey:(i=this.socket.accessToken)!==null&&i!==void 0?i:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);c.rateLimited&&s("rate limited"),e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=me.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(be.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const r=new _n(this,be.leave,{},e);r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,i){const r=new AbortController,s=setTimeout(()=>r.abort(),i),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new _n(this,e,n,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,i){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,i){var r,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=be;if(i&&[a,l,c,u].indexOf(o)>=0&&i!==this._joinRef())return;let v=this._onMessage(o,n,i);if(n&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var g,C,y;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(C=f.filter)===null||C===void 0?void 0:C.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(f=>f.callback(v,i)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var g,C,y,M,E,k;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const O=f.id,j=(g=f.filter)===null||g===void 0?void 0:g.event;return O&&((C=n.ids)===null||C===void 0?void 0:C.includes(O))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const O=(E=(M=f==null?void 0:f.filter)===null||M===void 0?void 0:M.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return O==="*"||O===((k=n==null?void 0:n.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof v=="object"&&"ids"in v){const g=v.data,{schema:C,table:y,commit_timestamp:M,type:E,errors:k}=g;v=Object.assign(Object.assign({},{schema:C,table:y,commit_timestamp:M,eventType:E,new:{},old:{},errors:k}),this._getPayloadRecords(g))}f.callback(v,i)})}_isClosed(){return this.state===me.closed}_isJoined(){return this.state===me.joined}_isJoining(){return this.state===me.joining}_isLeaving(){return this.state===me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,i){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const i=e.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===i&&zn.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const i in e)if(e[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(be.close,{},e)}_onError(e){this._on(be.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ii(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ii(e.columns,e.old_record)),n}}const pa=()=>{};class ya{constructor(e,n){var i,r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=aa,this.params={},this.timeout=kr,this.transport=sa.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=pa,this.conn=null,this.sendBuffer=[],this.serializer=new ca,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch=="undefined"?l=(...c)=>$t(()=>Promise.resolve().then(function(){return qt}),void 0).then(({default:u})=>u(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${Rn.websocket}`,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.transport&&(this.transport=n.transport),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(i=n==null?void 0:n.params)===null||i===void 0?void 0:i.eventsPerSecond;s&&(this.eventsPerSecondLimitMs=Math.floor(1e3/s));const o=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;o&&(this.accessToken=o),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(a,l)=>l(JSON.stringify(a)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new xr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n!=null?n:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,i){this.logger(e,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case St.connecting:return Be.Connecting;case St.open:return Be.Open;case St.closing:return Be.Closing;default:return Be.Closed}}isConnected(){return this.connectionState()===Be.Open}channel(e,n={config:{}}){const i=new zn(`realtime:${e}`,n,this);return this.channels.push(i),i}push(e){const{topic:n,event:i,payload:r,ref:s}=e;let o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};if(this.log("push",`${n} ${i} (${s})`,r),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(i)){if(this._throttle(o)())return"rate limited"}else o();else this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(be.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:la}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:i,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${i} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(a=>a._isMember(i)).forEach(a=>a._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(be.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${i}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ua,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(e,n=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(e(),n>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},n)),!1)}}class Hn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function de(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class ba extends Hn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Fi extends Hn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var wa=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};const Tr=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...n)=>$t(()=>Promise.resolve().then(function(){return qt}),void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)},_a=()=>wa(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield $t(()=>Promise.resolve().then(function(){return qt}),void 0)).Response:Response});var lt=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};const Sn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Sa=(t,e)=>lt(void 0,void 0,void 0,function*(){const n=yield _a();t instanceof n?t.json().then(i=>{e(new ba(Sn(i),t.status||500))}).catch(i=>{e(new Fi(Sn(i),i))}):e(new Fi(Sn(t),t))}),ka=(t,e,n,i)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};function sn(t,e,n,i,r,s){return lt(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(n,ka(e,i,r,s)).then(l=>{if(!l.ok)throw l;return i!=null&&i.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Sa(l,a))})})}function Pn(t,e,n,i){return lt(this,void 0,void 0,function*(){return sn(t,"GET",e,n,i)})}function Pe(t,e,n,i,r){return lt(this,void 0,void 0,function*(){return sn(t,"POST",e,i,r,n)})}function xa(t,e,n,i,r){return lt(this,void 0,void 0,function*(){return sn(t,"PUT",e,i,r,n)})}function Er(t,e,n,i,r){return lt(this,void 0,void 0,function*(){return sn(t,"DELETE",e,i,r,n)})}var ye=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};const Ca={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Di={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ta{constructor(e,n={},i,r){this.url=e,this.headers=n,this.bucketId=i,this.fetch=Tr(r)}uploadOrUpdate(e,n,i,r){return ye(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Di),r),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&i instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",i)):typeof FormData!="undefined"&&i instanceof FormData?(s=i,s.append("cacheControl",o.cacheControl)):(s=i,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(n),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));if(u.ok)return{data:{path:l},error:null};{const h=yield u.json();return{data:null,error:h}}}catch(s){if(de(s))return{data:null,error:s};throw s}})}upload(e,n,i){return ye(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,i)})}uploadToSignedUrl(e,n,i,r){return ye(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:Di.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob!="undefined"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",i)):typeof FormData!="undefined"&&i instanceof FormData?(l=i,l.append("cacheControl",c.cacheControl)):(l=i,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u});if(h.ok)return{data:{path:s},error:null};{const v=yield h.json();return{data:null,error:v}}}catch(l){if(de(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return ye(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=yield Pe(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+i.url),s=r.searchParams.get("token");if(!s)throw new Hn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}})}update(e,n,i){return ye(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,i)})}move(e,n){return ye(this,void 0,void 0,function*(){try{return{data:yield Pe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}})}copy(e,n){return ye(this,void 0,void 0,function*(){try{return{data:{path:(yield Pe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,i){return ye(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield Pe(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const o=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,i){return ye(this,void 0,void 0,function*(){try{const r=yield Pe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}download(e,n){return ye(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)!="undefined"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Pn(this.fetch,`${this.url}/${r}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(de(a))return{data:null,error:a};throw a}})}getPublicUrl(e,n){const i=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const a=typeof(n==null?void 0:n.transform)!="undefined"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${i}${c}`)}}}remove(e){return ye(this,void 0,void 0,function*(){try{return{data:yield Er(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}})}list(e,n,i){return ye(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Ca),n),{prefix:e||""});return{data:yield Pe(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(de(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ea="2.5.4",Oa={"X-Client-Info":`storage-js/${Ea}`};var et=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};class Aa{constructor(e,n={},i){this.url=e,this.headers=Object.assign(Object.assign({},Oa),n),this.fetch=Tr(i)}listBuckets(){return et(this,void 0,void 0,function*(){try{return{data:yield Pn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(de(e))return{data:null,error:e};throw e}})}getBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield Pn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return et(this,void 0,void 0,function*(){try{return{data:yield Pe(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}})}updateBucket(e,n){return et(this,void 0,void 0,function*(){try{return{data:yield xa(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(de(i))return{data:null,error:i};throw i}})}emptyBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield Pe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}})}deleteBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield Er(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(de(n))return{data:null,error:n};throw n}})}}class Ra extends Aa{constructor(e,n={},i){super(e,n,i)}from(e){return new Ta(this.url,this.headers,e,this.fetch)}}const $a="2.38.0";let bt="";typeof Deno!="undefined"?bt="deno":typeof document!="undefined"?bt="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?bt="react-native":bt="node";const Pa={"X-Client-Info":`supabase-js-${bt}/${$a}`};var qa=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};const ja=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=Bn:e=fetch,(...n)=>e(...n)},Ia=()=>typeof Headers=="undefined"?Et.exports.Headers:Headers,La=(t,e,n)=>{const i=ja(n),r=Ia();return(s,o)=>qa(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new r(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),i(s,Object.assign(Object.assign({},o),{headers:c}))})};function Va(t){return t.replace(/\/$/,"")}function Ma(t,e){const{db:n,auth:i,realtime:r,global:s}=t,{db:o,auth:a,realtime:l,global:c}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},a),i),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),s)}}function Fa(t){return Math.round(Date.now()/1e3)+t}function Da(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ee=()=>typeof document!="undefined",Fe={tested:!1,writable:!1},xt=()=>{if(!Ee())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fe.tested)return Fe.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Fe.tested=!0,Fe.writable=!0}catch{Fe.tested=!0,Fe.writable=!1}return Fe.writable};function kn(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((i,r)=>{e[r]=i}),e}const Or=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...n)=>$t(()=>Promise.resolve().then(function(){return qt}),void 0).then(({default:i})=>i(...n)):e=fetch,(...n)=>e(...n)},Ba=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",tt=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Nt=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},xn=async(t,e)=>{await t.removeItem(e)};function Ua(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",i,r,s,o,a,l,c,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)o=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),i=o<<2|a>>4,r=(a&15)<<4|l>>2,s=(l&3)<<6|c,n=n+String.fromCharCode(i),l!=64&&r!=0&&(n=n+String.fromCharCode(r)),c!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class on{constructor(){this.promise=new on.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}on.promiseConstructor=Promise;function Bi(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const i=n[1];return JSON.parse(Ua(i))}async function za(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Ha(t,e){return new Promise((i,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){i(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function Na(t){return("0"+t.toString(16)).substr(-2)}function mt(){const e=new Uint32Array(56);if(typeof crypto=="undefined"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,Na).join("")}async function Ka(t){const n=new TextEncoder().encode(t),i=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(i);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function Wa(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gt(t){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Ka(t);return Wa(n)}class Nn extends Error{constructor(e,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n}}function Y(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Ja extends Nn{constructor(e,n){super(e,n),this.name="AuthApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Ga(t){return Y(t)&&t.name==="AuthApiError"}class Ar extends Nn{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ut extends Nn{constructor(e,n,i){super(e),this.name=n,this.status=i}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class nt extends ut{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Cn extends ut{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class Kt extends ut{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Wt extends ut{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ui extends ut{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qn extends ut{constructor(e,n){super(e,"AuthRetryableFetchError",n)}}function zi(t){return Y(t)&&t.name==="AuthRetryableFetchError"}var Qa=globalThis&&globalThis.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const wt=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ya=[502,503,504];async function Hi(t){if(!Ba(t))throw new qn(wt(t),0);if(Ya.includes(t.status))throw new qn(wt(t),t.status);let e;try{e=await t.json()}catch(n){throw new Ar(wt(n),n)}throw new Ja(wt(e),t.status||500)}const Xa=(t,e,n,i)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),n))};async function X(t,e,n,i){var r;const s=Object.assign({},i==null?void 0:i.headers);i!=null&&i.jwt&&(s.Authorization=`Bearer ${i.jwt}`);const o=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(o.redirect_to=i.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Za(t,e,n+a,{headers:s,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(l):{data:Object.assign({},l),error:null}}async function Za(t,e,n,i,r,s){const o=Xa(e,i,r,s);let a;try{a=await t(n,o)}catch(l){throw console.error(l),new qn(wt(l),0)}if(a.ok||await Hi(a),i!=null&&i.noResolveJson)return a;try{return await a.json()}catch(l){await Hi(l)}}function Ae(t){var e;let n=null;il(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Fa(t.expires_in)));const i=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:i},error:null}}function qe(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function el(t){return{data:t,error:null}}function tl(t){const{action_link:e,email_otp:n,hashed_token:i,redirect_to:r,verification_type:s}=t,o=Qa(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:i,redirect_to:r,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function nl(t){return t}function il(t){return t.access_token&&t.refresh_token&&t.expires_in}var rl=globalThis&&globalThis.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};class sl{constructor({url:e="",headers:n={},fetch:i}){this.url=e,this.headers=n,this.fetch=Or(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await X(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Y(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,n={}){try{return await X(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:qe})}catch(i){if(Y(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:n}=e,i=rl(e,["options"]),r=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await X(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:tl,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Y(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await X(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qe})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,i,r,s,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await X(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:nl});if(u.error)throw u.error;const h=await u.json(),v=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const C=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);c[`${y}Page`]=C}),c.total=parseInt(v)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Y(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await X(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qe})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await X(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:qe})}catch(i){if(Y(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,n=!1){try{return await X(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:qe})}catch(i){if(Y(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){try{const{data:n,error:i}=await X(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:i}}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await X(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}}const Rr="2.55.0",ol="http://localhost:9999",al="supabase.auth.token",ll={"X-Client-Info":`gotrue-js/${Rr}`},Ni=10,ul={getItem:t=>xt()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{!xt()||globalThis.localStorage.setItem(t,e)},removeItem:t=>{!xt()||globalThis.localStorage.removeItem(t)}};function Ki(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function cl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}globalThis&&xt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class dl extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}cl();const hl={url:ol,storageKey:al,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ll,flowType:"implicit",debug:!1},pt=30*1e3,Wi=3;async function fl(t,e,n){return await n()}class At{constructor(e){var n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=At.nextInstanceID,At.nextInstanceID+=1,this.instanceID>0&&Ee()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},hl),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new sl({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Or(i.fetch),this.lock=i.lock||fl,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:xt()?this.storage=ul:(this.memoryStorage={},this.storage=Ki(this.memoryStorage)):(this.memoryStorage={},this.storage=Ki(this.memoryStorage)),Ee()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Rr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=Ee()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:i}=await this._getSessionFromURL(e);if(i)return this._debug("#_initialize()","error detecting session from URL",i),await this._removeSession(),{error:i};const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Y(e)?{error:e}:{error:new Ar("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var n,i,r;try{await this._removeSession();let s;if("email"in e){const{email:u,password:h,options:v}=e;let f=null,g=null;if(this.flowType==="pkce"){const C=mt();await tt(this.storage,`${this.storageKey}-code-verifier`,C),f=await gt(C),g=C===f?"plain":"s256"}s=await X(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:u,password:h,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:f,code_challenge_method:g},xform:Ae})}else if("phone"in e){const{phone:u,password:h,options:v}=e;s=await X(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(i=v==null?void 0:v.data)!==null&&i!==void 0?i:{},channel:(r=v==null?void 0:v.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:Ae})}else throw new Kt("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Y(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:a}=e;n=await X(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ae})}else if("phone"in e){const{phone:s,password:o,options:a}=e;n=await X(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ae})}else throw new Kt("You must provide either an email or phone number and a password");const{data:i,error:r}=n;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Cn}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:{user:i.user,session:i.session},error:r})}catch(n){if(Y(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,i,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await Nt(this.storage,`${this.storageKey}-code-verifier`),{data:i,error:r}=await X(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ae});return await xn(this.storage,`${this.storageKey}-code-verifier`),r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Cn}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:i,error:r})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:i,token:r,access_token:s,nonce:o}=e,a=await X(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ae}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Cn}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(Y(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,i,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:l}=e;let c=null,u=null;if(this.flowType==="pkce"){const v=mt();await tt(this.storage,`${this.storageKey}-code-verifier`,v),c=await gt(v),u=v===c?"plain":"s256"}const{error:h}=await X(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await X(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Kt("You must provide either an email or phone number.")}catch(a){if(Y(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,i;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:o,error:a}=await X(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:Ae});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(Y(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,i,r;try{return await this._removeSession(),await X(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:el})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:i}=e;if(i)throw i;if(!n)throw new nt;const{error:r}=await X(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Y(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:s}=e,{error:o}=await X(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:i,type:r,options:s}=e,{data:o,error:a}=await X(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Kt("You must provide either an email or phone number and a type")}catch(n){if(Y(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Nt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i)return{data:{session:e},error:null};const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await X(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qe}):await this._useSession(async n=>{var i,r;const{data:s,error:o}=n;if(o)throw o;return await X(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:qe})})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async i=>{const{data:r,error:s}=i;if(s)throw s;if(!r.session)throw new nt;const o=r.session;let a=null,l=null;if(this.flowType==="pkce"&&e.email!=null){const h=mt();await tt(this.storage,`${this.storageKey}-code-verifier`,h),a=await gt(h),l=h===a?"plain":"s256"}const{data:c,error:u}=await X(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:qe});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(i){if(Y(i))return{data:{user:null},error:i};throw i}}_decodeJWT(e){return Bi(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nt;const n=Date.now()/1e3;let i=n,r=!0,s=null;const o=Bi(e.access_token);if(o.exp&&(i=o.exp,r=i<=n),r){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Y(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var i;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(i=o.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new nt;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Y(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!Ee())throw new Wt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Wt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Ui("Not a valid PKCE flow url.");const n=kn(window.location.href);if(e){if(!n.code)throw new Ui("No code detected.");const{data:E,error:k}=await this._exchangeCodeForSession(n.code);if(k)throw k;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:E.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new Wt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=n;if(!s||!a||!o||!c)throw new Wt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let v=u+h;l&&(v=parseInt(l));const f=v-u;f*1e3<=pt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=v-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,v,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,v,u);const{data:C,error:y}=await this._getUser(s);if(y)throw y;const M={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:h,expires_at:v,refresh_token:o,token_type:c,user:C.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:M,redirectType:n.type},error:null}}catch(n){if(Y(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=kn(window.location.href);return!!(Ee()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=kn(window.location.href),n=await Nt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:r,error:s}=n;if(s)return{error:s};const o=(i=r.session)===null||i===void 0?void 0:i.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Ga(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await xn(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=Da(),i={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async n=>{var i,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let i=null,r=null;if(this.flowType==="pkce"){const s=mt();await tt(this.storage,`${this.storageKey}-code-verifier`,s),i=await gt(s),r=s===i?"plain":"s256"}try{return await X(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await Ha(async r=>(await za(r*200),this._debug(n,"refreshing attempt",r),await X(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ae})),(r,s,o)=>o&&o.error&&zi(o.error)&&Date.now()+(r+1)*200-i<pt)}catch(i){if(this._debug(n,"error",i),Y(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const i=await this._getUrlForProvider(e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",i),Ee()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Nt(this.storage,this.storageKey);if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=i.expires_at)!==null&&e!==void 0?e:1/0)<r+Ni;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Ni}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),zi(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,i;if(!e)throw new nt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new on;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new nt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(r,"error",s),Y(s)){const o={session:null,error:s};return(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),tt(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await xn(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ee()&&(window==null?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/pt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${pt}ms, refresh threshold is ${Wi} ticks`),r<=Wi&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof dl)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ee()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n){const i=[`provider=${encodeURIComponent(e)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const r=mt();await tt(this.storage,`${this.storageKey}-code-verifier`,r);const s=await gt(r),o=r===s?"plain":"s256";this._debug("PKCE","code verifier",`${r.substring(0,5)}...`,"code challenge",s,"method",o);const a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n!=null&&n.queryParams){const r=new URLSearchParams(n.queryParams);i.push(r.toString())}return`${this.url}/authorize?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var i;const{data:r,error:s}=n;return s?{data:null,error:s}:await X(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var i,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:a,error:l}=await X(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(i=s==null?void 0:s.session)===null||i===void 0?void 0:i.access_token});return l?{data:null,error:l}:(!((r=a==null?void 0:a.totp)===null||r===void 0)&&r.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:a}=await X(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(Y(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:r,error:s}=n;return s?{data:null,error:s}:await X(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Y(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=(e==null?void 0:e.factors)||[],r=i.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:i,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,i;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((i=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}At.nextInstanceID=0;class vl extends At{constructor(e){super(e)}}var ml=globalThis&&globalThis.__awaiter||function(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})};const gl={headers:Pa},pl={schema:"public"},yl={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bl={};class wl{constructor(e,n,i){var r,s,o,a,l,c,u,h;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const v=Va(e);this.realtimeUrl=`${v}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${v}/auth/v1`,this.storageUrl=`${v}/storage/v1`,this.functionsUrl=`${v}/functions/v1`;const f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:pl,realtime:bl,auth:Object.assign(Object.assign({},yl),{storageKey:f}),global:gl},C=Ma(i!=null?i:{},g);this.storageKey=(s=(r=C.auth)===null||r===void 0?void 0:r.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=(o=C.global)===null||o===void 0?void 0:o.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((l=C.auth)!==null&&l!==void 0?l:{},this.headers,(c=C.global)===null||c===void 0?void 0:c.fetch),this.fetch=La(n,this._getAccessToken.bind(this),(u=C.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},C.realtime)),this.rest=new Un(`${v}/rest/v1`,{headers:this.headers,schema:(h=C.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new qo(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ra(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},i){return this.rest.rpc(e,n,i)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return ml(this,void 0,void 0,function*(){const{data:i}=yield this.auth.getSession();return(n=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:i,storage:r,storageKey:s,flowType:o,debug:a},l,c){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vl({url:this.authUrl,headers:Object.assign(Object.assign({},u),l),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:i,storage:r,flowType:o,debug:a,fetch:c})}_initRealtimeClient(e){return new ya(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,n,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?(this.realtime.setAuth(i!=null?i:null),this.changedAccessToken=i):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _l=(t,e,n)=>new wl(t,e,n);var Sl=_e({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(t,{slots:e,emit:n}){const i=ce(),r=z(null);let s=0;const o=[];function a(f){const g=typeof f=="boolean"?f:t.noErrorFocus!==!0,C=++s,y=(k,O)=>{n("validation"+(k===!0?"Success":"Error"),O)},M=k=>{const O=k.validate();return typeof O.then=="function"?O.then(j=>({valid:j,comp:k}),j=>({valid:!1,comp:k,err:j})):Promise.resolve({valid:O,comp:k})};return(t.greedy===!0?Promise.all(o.map(M)).then(k=>k.filter(O=>O.valid!==!0)):o.reduce((k,O)=>k.then(()=>M(O).then(j=>{if(j.valid===!1)return Promise.reject(j)})),Promise.resolve()).catch(k=>[k])).then(k=>{if(k===void 0||k.length===0)return C===s&&y(!0),!0;if(C===s){const{comp:O,err:j}=k[0];if(j!==void 0&&console.error(j),y(!1,O),g===!0){const U=k.find(({comp:D})=>typeof D.focus=="function"&&Ln(D.$)===!1);U!==void 0&&U.comp.focus()}}return!1})}function l(){s++,o.forEach(f=>{typeof f.resetValidation=="function"&&f.resetValidation()})}function c(f){f!==void 0&&ge(f);const g=s+1;a().then(C=>{g===s&&C===!0&&(t.onSubmit!==void 0?n("submit",f):f!==void 0&&f.target!==void 0&&typeof f.target.submit=="function"&&f.target.submit())})}function u(f){f!==void 0&&ge(f),n("reset"),ae(()=>{l(),t.autofocus===!0&&t.noResetFocus!==!0&&h()})}function h(){Pt(()=>{if(r.value===null)return;const f=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),g=>g.tabIndex>-1);f!=null&&f.focus({preventScroll:!0})})}ys(Ji,{bindComponent(f){o.push(f)},unbindComponent(f){const g=o.indexOf(f);g>-1&&o.splice(g,1)}});let v=!1;return Rt(()=>{v=!0}),In(()=>{v===!0&&t.autofocus===!0&&h()}),at(()=>{t.autofocus===!0&&h()}),Object.assign(i.proxy,{validate:a,resetValidation:l,submit:c,reset:u,focus:h,getValidationComponents:()=>o}),()=>R("form",{class:"q-form",ref:r,onSubmit:c,onReset:u},Ce(e.default))}});const kl="https://vhfymgdmtvjpitnlruuq.supabase.co",xl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZoZnltZ2RtdHZqcGl0bmxydXVxIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTYyMDY0ODMsImV4cCI6MjAxMTc4MjQ4M30.rtFqHXabezswjJydQTYembdjoRa8Il1QKBYH71VQtOw",Cl=Zi({__name:"RegistrationForm",setup(t){const e=_l(kl,xl),{t:n}=Ts({useScope:"global"}),i=z({phone_number:"",first_name:"",last_name:"",age:"",gender:"",bio:""}),r=z(!1),s=z(),o=[{id:"cb267d3f-ac75-4a07-99fa-40f2c2e5b91f",label:"male"},{id:"2465f2f8-389d-40ce-b2d8-111298eb2b68",label:"female"}],a=[];for(let u=18;u<100;u++)a.push(u);const l=()=>{const u=[];for(let h=0;h<o.length;h++){const v=o[h],f={id:v.id,label:n(v.label)};u.push(f)}return u},c=async()=>{var v;if(!await((v=s.value)==null?void 0:v.validate()))return;r.value=!0;const h=await e.from("USERS").insert([i.value]);r.value=!1,h.status===201?li.create({message:"Successfully Registered!",color:"positive",position:"top"}):li.create({message:"Oops we are having an issue",color:"negative",position:"top"})};return(u,h)=>(er(),tr(bs(Sl),{ref_key:"form",ref:s,class:"row justify-between q-col-gutter-y-md q-col-gutter-x-sm"},{default:nr(()=>[Re(Ut,{modelValue:i.value.phone_number,"onUpdate:modelValue":h[0]||(h[0]=v=>i.value.phone_number=v),class:"col-12",mask:"(###) ###-####",label:u.$t("phoneNumber"),rules:[v=>!!v||"Required"],dense:""},null,8,["modelValue","label","rules"]),Re(Ut,{modelValue:i.value.first_name,"onUpdate:modelValue":h[1]||(h[1]=v=>i.value.first_name=v),class:"col-6",label:u.$t("firstName"),rules:[v=>!!v||"Required"],dense:""},null,8,["modelValue","label","rules"]),Re(Ut,{modelValue:i.value.last_name,"onUpdate:modelValue":h[2]||(h[2]=v=>i.value.last_name=v),class:"col-6",label:u.$t("lastName"),rules:[v=>!!v||"Required"],dense:""},null,8,["modelValue","label","rules"]),Re(Pi,{modelValue:i.value.age,"onUpdate:modelValue":h[3]||(h[3]=v=>i.value.age=v),options:a,class:"col-6",label:u.$t("age"),rules:[v=>!!v||"Required"],dense:""},null,8,["modelValue","label","rules"]),Re(Pi,{modelValue:i.value.gender,"onUpdate:modelValue":h[4]||(h[4]=v=>i.value.gender=v),options:l(),"emit-value":"","map-options":"","option-value":"id","option-label":"label",class:"col-6",label:u.$t("gender"),rules:[v=>!!v||"Required"],dense:""},null,8,["modelValue","options","label","rules"]),Re(Ut,{modelValue:i.value.bio,"onUpdate:modelValue":h[5]||(h[5]=v=>i.value.bio=v),class:"col-12",label:u.$t("bio"),rules:[v=>!!v||"Required"],type:"textarea",dense:"",autogrow:""},null,8,["modelValue","label","rules"]),Re(ws,{label:u.$t("submit"),class:"col q-py-xs q-mt-md q-mx-lg",onClick:c,color:"primary",noCaps:"",loading:r.value},null,8,["label","loading"])]),_:1},512))}}),Al=Zi({__name:"IndexPage",setup(t){return(e,n)=>(er(),tr(Os,{class:"q-pa-md row justify-center items-start"},{default:nr(()=>[Re(Cl,{style:{"max-width":"30rem"}})]),_:1}))}});export{Al as default};
